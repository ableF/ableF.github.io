<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="renderer" content="webkit"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.0.0-rc.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.0.0-rc.0" type="image/png" sizes="32x32"><meta name="description" content="è°ä¸æ˜¯ï¼Œæ‹¼äº†å‘½èµ°åˆ°ç”Ÿå‘½çš„ç»“å°¾">
<meta property="og:type" content="website">
<meta property="og:title" content="æ— åä¹‹è¾ˆ">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="æ— åä¹‹è¾ˆ">
<meta property="og:description" content="è°ä¸æ˜¯ï¼Œæ‹¼äº†å‘½èµ°åˆ°ç”Ÿå‘½çš„ç»“å°¾">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="å‰ç«¯ä¸€å²å°ç™½-able.Feng">
<meta name="twitter:card" content="summary"><meta name="keywords" content="å‰ç«¯ä¸€å²å°ç™½-able.Feng, æ— åä¹‹è¾ˆ"><meta name="description" content="è°ä¸æ˜¯ï¼Œæ‹¼äº†å‘½èµ°åˆ°ç”Ÿå‘½çš„ç»“å°¾"><title>æ— åä¹‹è¾ˆ</title><link ref="canonical" href="http://yoursite.com/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.0.0-rc.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">æ— åä¹‹è¾ˆ</div><div class="header-banner-info__subtitle"></div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/06/26/es2021%E6%96%B0%E7%89%B9%E6%80%A7/">es2021æ–°ç‰¹æ€§</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-06-26</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>ECMAScript 2021 æ–°ç‰¹æ€§</p>
<p>1 String.prototype.replaceAll()<br>åœ¨JavaScriptä¸­ï¼Œreplace()æ–¹æ³•åªæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰åŒ¹é…é¡¹ï¼Œå”¯ä¸€çš„åŠæ³•å°±ä½¿ç”¨å…¨å±€æ­£åˆ™è¡¨è¾¾å¼ã€‚<br>æ–°ç‰¹æ€§replaceAll()ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„åŒ¹é…é¡¹éƒ½ä¼šè¢«æ›¿æ¢æ‰ã€‚æ¨¡å¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ›¿æ¢çš„å†…å®¹å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–æ˜¯ä¸ºæ¯ä¸ªåŒ¹é…é¡¹æ‰§è¡Œçš„å‡½æ•°ã€‚</p>
<p>åŸæœ¬çš„replace()åªèƒ½æ›¿æ¢æ‰ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">"å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹ "</span></span><br><span class="line"><span class="keyword">const</span> newStr = str.replace(<span class="string">"å®¡æ‰¹"</span>, <span class="string">"äººäº‹"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(newStr) <span class="comment">// äººäº‹ å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹</span></span><br></pre></td></tr></table></div></figure>
<p>å¦‚æœæƒ³è¦å®Œå…¨åŒ¹é…æ›¿æ¢éœ€è¦å†™å…¨å±€æ­£åˆ™è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">"å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹"</span></span><br><span class="line"><span class="keyword">const</span> newStr = str.replace(<span class="regexp">/å®¡æ‰¹/g</span>, <span class="string">"äººäº‹"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(newStr) <span class="comment">// äººäº‹ äººäº‹ äººäº‹ äººäº‹</span></span><br></pre></td></tr></table></div></figure>
<p>æ–°çš„replaceAll()ç‰¹æ€§ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">"å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹ å®¡æ‰¹"</span></span><br><span class="line"><span class="keyword">const</span> newStr = str.replaceAll(<span class="string">"å®¡æ‰¹"</span>, <span class="string">"äººäº‹"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(newStr) <span class="comment">//äººäº‹ äººäº‹ äººäº‹ äººäº‹</span></span><br></pre></td></tr></table></div></figure>

<p>2 Promise.any<br>ES2020å·²ç»é€šè¿‡äº†Promiseçš„allSettled()æ–¹æ³•ã€‚ES2021 Promiseé˜µè¥å°†æœ‰ä¸€ä¸ªæ–°çš„æˆå‘˜ï¼Œany()ã€‚<br>å½“Promiseåˆ—è¡¨ä¸­çš„ä»»æ„ä¸€ä¸ªpromiseæˆåŠŸresolveåˆ™ä¼šçŸ­è·¯å¹¶è¿”å›ç¬¬ä¸€ä¸ªresolveçš„ç»“æœçŠ¶æ€ï¼Œ å¦‚æœæ‰€æœ‰çš„promiseå‡rejectï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸AggregateErrorï¼Œè¡¨ç¤ºæ‰€æœ‰è¯·æ±‚å¤±è´¥ã€‚<br>Promise.any()ä¸Promise.race()ååˆ†å®¹æ˜“æ··æ·†ï¼ŒåŠ¡å¿…æ³¨æ„åŒºåˆ†ã€‚Promise.race() ä¸€æ—¦æŸä¸ªpromiseè§¦å‘äº†resolveæˆ–è€…rejectï¼Œå°±ç›´æ¥è¿”å›äº†è¯¥çŠ¶æ€çš„ç»“æœã€‚<br>å³ä½¿Promiseåœ¨resolveçš„ä¹‹å‰è¢«rejectï¼ŒPromise.any()ä»å°†è¿”å›ç¬¬ä¸€ä¸ªresolveçš„ç»“æœï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.any([</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> setTimeout(reject(<span class="string">'workflow'</span>), <span class="number">100</span>)),</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> setTimeout(resolve(<span class="string">'staff'</span>), <span class="number">1000</span>)),</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> setTimeout(resolve(<span class="string">'holiday'</span>), <span class="number">2000</span>))</span><br><span class="line">])</span><br><span class="line">    .then(<span class="function">(<span class="params">value</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">`ç»“æœï¼š<span class="subst">$&#123;value&#125;</span>`</span>)) <span class="comment">// ç»“æœï¼šstaff</span></span><br><span class="line">    .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.log(err));</span><br></pre></td></tr></table></div></figure>
<p>å½“æ‰€æœ‰promiseéƒ½ä¸ºrejectä¼šæŠ›å‡ºå¼‚å¸¸AggregateError: All promises were rejectedï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.any([</span><br><span class="line">    <span class="built_in">Promise</span>.reject(<span class="string">'Error one'</span>),</span><br><span class="line">    <span class="built_in">Promise</span>.reject(<span class="string">'Error two'</span>),</span><br><span class="line">    <span class="built_in">Promise</span>.reject(<span class="string">'Error three'</span>)</span><br><span class="line">])</span><br><span class="line">    .then(<span class="function">(<span class="params">value</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">`ç»“æœï¼š<span class="subst">$&#123;value&#125;</span>`</span>))</span><br><span class="line">    .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.log(err)); <span class="comment">// AggregateError: All promises were rejected</span></span><br></pre></td></tr></table></div></figure>
<p>3 é€»è¾‘è¿ç®—ç¬¦å’Œèµ‹å€¼è¡¨è¾¾å¼<br>åœ¨JavaScriptä¸­ï¼Œæœ‰å¾ˆå¤šèµ‹å€¼æ“ä½œç¬¦å’Œé€»è¾‘æ“ä½œç¬¦ï¼Œåœ¨æ–°çš„è‰æ¡ˆä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»„åˆé€»è¾‘è¿ç®—ç¬¦å’Œèµ‹å€¼è¿ç®—ç¬¦ã€‚<br>a &amp;&amp;= b å½“aå€¼å­˜åœ¨æ—¶ï¼Œå°†bå˜é‡èµ‹å€¼ç»™aï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a &amp;&amp;= b</span><br><span class="line"><span class="comment">//ç­‰ä»·äº</span></span><br><span class="line"><span class="comment">// 1. a &amp;&amp; (a = b)</span></span><br><span class="line"><span class="comment">// 2. if (a) a = b</span></span><br></pre></td></tr></table></div></figure>
<p>a ||= b å½“aå€¼ä¸å­˜åœ¨æ—¶ï¼Œå°†bå˜é‡èµ‹å€¼ç»™aï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a ||= b</span><br><span class="line"><span class="comment">//ç­‰ä»·äº</span></span><br><span class="line"><span class="comment">// 1. a || (a = b)</span></span><br><span class="line"><span class="comment">// 2. if (!a) a = b</span></span><br></pre></td></tr></table></div></figure>
<p>a ??= b å½“aå€¼ä¸ºnullæˆ–è€…undefinedæ—¶ï¼Œå°†bå˜é‡èµ‹å€¼ç»™aï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a</span><br><span class="line"><span class="keyword">let</span> b = <span class="number">10</span></span><br><span class="line">a ??= b</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line">a = <span class="literal">false</span></span><br><span class="line">a ??= b</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> navigations = [</span><br><span class="line">    &#123;</span><br><span class="line">        title: <span class="string">'å·¥ä½œå°'</span>,</span><br><span class="line">        path: <span class="string">'/'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        title: <span class="string">'å®¡æ‰¹'</span>,</span><br><span class="line">        path: <span class="string">'/workflow'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        path: <span class="string">'/setting'</span></span><br><span class="line">    &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> navigation <span class="keyword">of</span> navigations) &#123;</span><br><span class="line">    page.title ??= <span class="string">'é»˜è®¤'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.table(pages);</span><br><span class="line"></span><br><span class="line"><span class="comment">//   (index)            title                     path</span></span><br><span class="line"><span class="comment">//   0                  "å·¥ä½œå°"           "/"</span></span><br><span class="line"><span class="comment">//   1                  "å®¡æ‰¹"                "/workflow"</span></span><br><span class="line"><span class="comment">//   2                  "é»˜è®¤"                "/setting"</span></span><br></pre></td></tr></table></div></figure>
<p>4 Private Methods &amp; Private Accessors</p>
<p>4.1 ç§æœ‰æ–¹æ³• Private Methods</p>
<p>ç§æœ‰æ–¹æ³•åªèƒ½åœ¨å®šä¹‰å®ƒçš„ç±»å†…éƒ¨è®¿é—®ï¼Œä¸“ç”¨æ–¹æ³•åç§°ä»¥#å¼€å¤´ã€‚ç”±äºsetType()æ˜¯ç§æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥personObj.setTypeè¿”å›undefinedï¼Œç”¨undefinedä½œå‡½æ•°ä¼šå¼•å‘TypeErrorã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Private method</span></span><br><span class="line">    ï»¿#setType() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Private'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Public method</span></span><br><span class="line">    show() &#123;</span><br><span class="line">        this.#setType();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> personObj = <span class="keyword">new</span> Person();</span><br><span class="line">personObj.show(); <span class="comment">// "Private"</span></span><br><span class="line">personObj.setType(); <span class="comment">// TypeError: personObj.setType is not a function</span></span><br></pre></td></tr></table></div></figure>
<p>4.2 ç§æœ‰è®¿é—®è€… Private Accessors</p>
<p>å¯ä»¥é€šè¿‡åœ¨å‡½æ•°åç§°å‰æ·»åŠ #ï¼Œä½¿å¾—è®¿é—®å™¨å‡½æ•°ç§æœ‰ã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œnameæ˜¯å…¬å…±çš„ï¼Œå¯ä»¥åƒæ™®é€šå±æ€§ä¸€æ ·è¯»å–å®ƒ, è€Œageåˆ™æ˜¯ç§æœ‰ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Public accessor</span></span><br><span class="line">    ï»¿<span class="keyword">get</span> name() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'able'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> name(value) &#123;&#125;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// Private accessor</span></span><br><span class="line">ï»¿    <span class="keyword">get</span> #age() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">18</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> #age(value) &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> personObj = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(personObj.name); <span class="comment">// "able"</span></span><br><span class="line"><span class="built_in">console</span>.log(personObj.age); <span class="comment">// undefined</span></span><br></pre></td></tr></table></div></figure>
<p>5 WeakRefs</p>
<p>å½“æˆ‘ä»¬é€šè¿‡const, let, varåˆ›å»ºä¸€ä¸ªå˜é‡æ—¶ï¼Œåƒåœ¾æ”¶é›†å™¨GCå°†æ°¸è¿œä¸ä¼šä»å†…å­˜ä¸­åˆ é™¤è¯¥å˜é‡ï¼Œåªè¦å®ƒçš„å¼•ç”¨ä»ç„¶å­˜åœ¨ä¸”å¯è®¿é—®ã€‚è€ŒWeakRefå¯¹è±¡åŒ…å«é’ˆå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œé’ˆå¯¹å¯¹è±¡çš„å¼±å¼•ç”¨æ˜¯ä¸ä¼šé˜»æ­¢åƒåœ¾æ”¶é›†å™¨GCçš„å›æ”¶çš„ï¼Œåˆ™GCå¯ä»¥åœ¨ä»»ä½•æ—¶å€™åˆ é™¤å®ƒã€‚</p>
<p>ä¾‹å¦‚æœ‰å¦‚ä¸‹åœºæ™¯ï¼š<br>è·Ÿè¸ªæŸä¸ªå¯¹è±¡è°ƒç”¨æŸä¸€ç‰¹å®šæ–¹æ³•çš„æ¬¡æ•°ï¼Œè¶…è¿‡1000æ¡åˆ™åšå¯¹åº”æç¤ºã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨Mapï¼Œè™½ç„¶å¯ä»¥å®ç°éœ€æ±‚ï¼Œä½†æ˜¯ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºï¼Œå› ä¸ºä¼ é€’ç»™doSomething()çš„æ¯ä¸ªå¯¹è±¡éƒ½æ°¸ä¹…ä¿å­˜åœ¨mapä¸­ï¼Œå¹¶ä¸”ä¸ä¼šè¢«GCå›æ”¶ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useObject</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    doSomething(obj);</span><br><span class="line">    <span class="keyword">let</span> called = map.get(obj) || <span class="number">0</span>;</span><br><span class="line">    called++;</span><br><span class="line">    <span class="keyword">if</span> (called &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'è°ƒç”¨æ¬¡æ•°å·²è¶…è¿‡1000æ¬¡'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    map.set(obj, called);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>æ‰€ä»¥ï¼Œå¯ä»¥é€šè¿‡WeakMap()æˆ–è€…WeakSet()æ¥ä½¿ç”¨WeakRefsã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wmap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">useObject</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    doSomething(obj);</span><br><span class="line">    <span class="keyword">let</span> called = wmap.get(obj) || <span class="number">0</span>;</span><br><span class="line">    called++;</span><br><span class="line">    <span class="keyword">if</span> (called &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'è°ƒç”¨æ¬¡æ•°å·²è¶…è¿‡1000æ¬¡'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    wmap.set(obj, called);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>å› ä¸ºæ˜¯å¼±å¼•ç”¨ï¼Œæ‰€ä»¥WeakMapã€WeakSetçš„é”®å€¼å¯¹æ˜¯ä¸å¯æšä¸¾çš„ã€‚WeakSetå’ŒWeakMapç›¸ä¼¼ï¼Œä½†æ˜¯æ¯ä¸ªå¯¹è±¡åœ¨WeakSetä¸­åªå¯èƒ½å‡ºç°ä¸€æ¬¡ï¼ŒWeakSetä¸­æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯å”¯ä¸€çš„ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"><span class="keyword">let</span> foo = &#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> bar = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">ws.add(foo);</span><br><span class="line">ws.add(bar);</span><br><span class="line"></span><br><span class="line">ws.has(foo); <span class="comment">// true</span></span><br><span class="line">ws.has(bar); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">ws.delete(foo); <span class="comment">// åˆ é™¤fooå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">ws.has(foo); <span class="comment">//false fooå·²åˆ é™¤</span></span><br><span class="line">ws.has(bar); <span class="comment">// barä»å­˜åœ¨</span></span><br></pre></td></tr></table></div></figure>
<p>WeakSetä¸Setç›¸æ¯”æœ‰ä»¥ä¸‹ä¸¤ä¸ªåŒºåˆ«ï¼š<br>ï‚·WeakSetåªèƒ½æ˜¯å¯¹è±¡é›†åˆï¼Œè€Œä¸èƒ½æ˜¯ä»»ä½•ç±»å‹çš„ä»»æ„å€¼<br>ï‚·WeakSetå¼±å¼•ç”¨ï¼Œé›†åˆä¸­å¯¹è±¡å¼•ç”¨ä¸ºå¼±å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¯¹WeakSetå¯¹è±¡çš„å¼•ç”¨ï¼Œåˆ™ä¼šè¢«GCå›æ”¶</p>
<p>æœ€åï¼ŒWeakRefå®ä¾‹æœ‰ä¸€ä¸ªæ–¹æ³•deref()ï¼Œè¿”å›å¼•ç”¨çš„åŸå§‹å¯¹è±¡ï¼Œå¦‚æœåŸå§‹å¯¹è±¡è¢«å›æ”¶ï¼Œåˆ™è¿”å›undefinedã€‚ä¸‹é¢å…¶åœ¨æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—ä¸­ç¼“å­˜çš„å¦™ç”¨ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cache = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setValue = <span class="function">(<span class="params">key, obj</span>) =&gt;</span> &#123;</span><br><span class="line">    cache.set(key, <span class="keyword">new</span> WeakRef(obj));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getValue = <span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> ref = cache.get(key);</span><br><span class="line">    <span class="keyword">if</span> (ref) &#123;</span><br><span class="line">        <span class="keyword">return</span> ref.deref();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fibonacciCached = <span class="function">(<span class="params">number</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> cached = getValue(number);</span><br><span class="line">    <span class="keyword">if</span> (cached) <span class="keyword">return</span> cached;</span><br><span class="line">    <span class="keyword">const</span> sum = calculateFibonacci(number);</span><br><span class="line">    setValue(number, sum);</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/05/22/TS%E7%B1%BB%E5%9E%8B%E5%85%BC%E5%AE%B9%E6%80%A7/">TSç±»å‹å…¼å®¹æ€§</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-05-22</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>åœ¨ TypeScript é‡Œï¼Œå› ä¸ºæœ‰é™æ€ç±»å‹æ£€æµ‹ï¼Œæˆ‘ä»¬å†ä¹Ÿä¸èƒ½åƒ JavaScript é‡Œé‚£æ ·èµ‹ç»™å˜é‡ä»»æ„ç±»å‹çš„å€¼ï¼Œè€Œèƒ½ä¸èƒ½æŠŠä¸€ä¸ªç±»å‹èµ‹å€¼ç»™å…¶ä»–ç±»å‹ï¼Œè¿™æ˜¯ç”±ç±»å‹å…¼å®¹æ€§å†³å®šã€‚</p>

        <h2 id="ç‰¹ä¾‹"   >
          <a href="#ç‰¹ä¾‹" class="heading-link"><i class="fas fa-link"></i></a>ç‰¹ä¾‹</h2>
      <p>ä»Šå¤©æˆ‘ä»¬çœ‹ä¸€ä¸‹ any ç­‰å‡ ä¸ªç‰¹æ®Šç±»å‹ï¼Œå®ƒä»¬åœ¨ç±»å‹å…¼å®¹æ€§è¿™å—ååˆ†æœ‰ç‰¹è‰²ã€‚</p>

        <h3 id="any"   >
          <a href="#any" class="heading-link"><i class="fas fa-link"></i></a>any</h3>
      <p>é¦–å…ˆæ˜¯ä¸‡é‡‘æ²¹ç±»å‹ anyï¼Œany ç±»å‹å¯ä»¥èµ‹å€¼ç»™é™¤äº† never ä¹‹å¤–ä»»æ„å…¶ä»–ç±»å‹ï¼Œåè¿‡æ¥å…¶ä»–ç±»å‹éƒ½å¯ä»¥èµ‹å€¼ç»™ anyï¼›æ¢å¥è¯è¯´ï¼Œå³ any å…¼å®¹é™¤äº† never ä¹‹å¤–æ‰€æœ‰ç±»å‹ã€åŒæ—¶è¢«æ‰€æœ‰å…¶ä»–ç±»å‹å…¼å®¹ã€‚å› ä¸º any å¤ªç‰¹æ®Šï¼Œè¿™é‡Œæˆ‘å°±ä¸å†ä¸¾ä¾‹å­äº†ï¼ŒåŒæ—¶å†å¼ºè°ƒä¸€ä¸‹ï¼ŒAny is ğŸ˜ˆï¼Œæˆ‘ä»¬è¦æ…ç”¨ã€å°‘ç”¨ anyã€‚</p>

        <h3 id="never"   >
          <a href="#never" class="heading-link"><i class="fas fa-link"></i></a>never</h3>
      <p>ä¸‹ä¸ªç‰¹ä¾‹æ˜¯ neverï¼Œå®ƒçš„ç‰¹æ€§æ˜¯å¯ä»¥èµ‹å€¼ç»™ä»»ä½•å…¶ä»–ç±»å‹ï¼Œä½†åè¿‡æ¥ä¸èƒ½è¢«å…¶ä»–ä»»ä½•ç±»å‹åŒ…æ‹¬ any åœ¨å†…èµ‹å€¼ã€‚å¦‚ä»¥ä¸‹ç¤ºä¾‹é‡Œæˆ‘ä»¬å¯ä»¥æŠŠ never èµ‹å€¼ç»™ numberã€å‡½æ•°ã€å¯¹è±¡ç±»å‹ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> never: never = <span class="function">(<span class="params">(</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">'never'</span>);</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="keyword">let</span> a: number = never; <span class="comment">// ok</span></span><br><span class="line">  <span class="keyword">let</span> b: <span class="function"><span class="params">()</span> =&gt;</span> any = never; <span class="comment">// ok</span></span><br><span class="line">  <span class="keyword">let</span> c: &#123;&#125; = never; <span class="comment">// ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="unknown"   >
          <a href="#unknown" class="heading-link"><i class="fas fa-link"></i></a>unknown</h3>
      <p>unknown çš„ç‰¹æ€§å‡ ä¹æ­£å¥½å’Œ never åè¿‡æ¥ï¼Œæˆ‘ä»¬ä¸èƒ½æŠŠ unknown èµ‹å€¼ç»™é™¤äº† any ä¹‹å¤–å…¶ä»–ä»»ä½•ç±»å‹ï¼›åè¿‡æ¥å…¶ä»–ç±»å‹éƒ½å¯ä»¥èµ‹å€¼ç»™ unknownã€‚å¦‚ä»¥ä¸‹ç¤ºä¾‹é‡Œï¼Œä¼šæç¤º ts(2322) unknown ç±»å‹ä¸èƒ½èµ‹å€¼ç»™å…¶ä»–ç±»å‹çš„é”™è¯¯ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> unknown: unknown;</span><br><span class="line">  <span class="keyword">const</span> a: number = unknown; <span class="comment">// ts(2322)</span></span><br><span class="line">  <span class="keyword">const</span> b: <span class="function"><span class="params">()</span> =&gt;</span> any = unknown; <span class="comment">// ts(2322)</span></span><br><span class="line">  <span class="keyword">const</span> c: &#123;&#125; = unknown; <span class="comment">// ts(2322)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="voidã€nullã€undefined"   >
          <a href="#voidã€nullã€undefined" class="heading-link"><i class="fas fa-link"></i></a>voidã€nullã€undefined</h3>
      <p>ä¸‰å¤§æ— ç”¨ç±»å‹çš„å…¼å®¹æ€§ä¹Ÿæ˜¯å¾ˆç‰¹åˆ«çš„ï¼Œæ¯”å¦‚ void ç±»å‹ä»…å¯èµ‹å€¼ç»™ any å’Œ unknown ç±»å‹ï¼Œåè¿‡æ¥ä»… anyã€neverã€undefined å¯èµ‹å€¼ç»™ voidã€‚æ­¤å¤–ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œnullã€undefined è¡¨ç°å‡ºä¸ void ç±»ä¼¼çš„å…¼å®¹æ€§ï¼Œä¸èƒ½èµ‹å€¼ç»™é™¤ any å’Œ unknown ä¹‹å¤–çš„å…¶ä»–ç±»å‹ï¼Œåè¿‡æ¥é™¤äº† any å’Œ never ä¹‹å¤–å…¶ä»–ç±»å‹éƒ½ä¸å¯ä»¥èµ‹å€¼ç»™ null æˆ–è€… undefinedã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> thisIsAny: any;</span><br><span class="line">  <span class="keyword">let</span> thisIsNever: never;</span><br><span class="line">  <span class="keyword">let</span> thisIsUnknown: unknown;</span><br><span class="line">  <span class="keyword">let</span> thisIsVoid: <span class="keyword">void</span>;</span><br><span class="line">  <span class="keyword">let</span> thisIsUndefined: <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">let</span> thisIsNull: <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  thisIsAny = thisIsVoid; <span class="comment">// ok</span></span><br><span class="line">  thisIsUnknown = thisIsVoid; <span class="comment">// ok</span></span><br><span class="line">  thisIsVoid = thisIsAny; <span class="comment">// ok</span></span><br><span class="line">  thisIsVoid = thisIsNever; <span class="comment">// ok</span></span><br><span class="line">  thisIsVoid = thisIsUndefined; <span class="comment">// ok</span></span><br><span class="line"></span><br><span class="line">  thisIsAny = thisIsNull; <span class="comment">// ok</span></span><br><span class="line">  thisIsUnknown = thisIsNull; <span class="comment">// ok</span></span><br><span class="line">  thisIsAny = thisIsUndefined; <span class="comment">// ok</span></span><br><span class="line">  thisIsUnknown = thisIsUndefined; <span class="comment">// ok</span></span><br><span class="line">  </span><br><span class="line">  thisIsNull = thisIsAny; <span class="comment">// ok</span></span><br><span class="line">  thisIsNull = thisIsNever; <span class="comment">// ok</span></span><br><span class="line">  thisIsUndefined = thisIsAny; <span class="comment">// ok</span></span><br><span class="line">  thisIsUndefined = thisIsNever; <span class="comment">// ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h3 id="enum"   >
          <a href="#enum" class="heading-link"><i class="fas fa-link"></i></a>enum</h3>
      <p>æœ€åä¸€ä¸ªç‰¹ä¾‹æ˜¯ enum æšä¸¾ç±»å‹ï¼Œå…¶ä¸­æ•°å­—æšä¸¾å’Œæ•°å­—ç±»å‹æ˜¯ç›¸äº’å…¼å®¹ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæšä¸¾ A èµ‹å€¼ç»™æ•°å­—ï¼ˆnumberï¼‰ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡æ•°å­—å­—é¢é‡ 1 æ›¿ä»£æšä¸¾ Aã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  enum A &#123;</span><br><span class="line">    one</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> num: number = A.one; <span class="comment">// oklet fun = (param: A) =&gt; void 0;</span></span><br><span class="line">  fun(<span class="number">1</span>); <span class="comment">// ok </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>æ­¤å¤–ï¼Œä¸åŒæšä¸¾ä¹‹é—´æ˜¯ä¸å…¼å®¹çš„ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹é‡Œï¼Œå› ä¸ºæšä¸¾ A å’Œ B ä¸å…¼å®¹ï¼Œæ‰€ä»¥éƒ½ä¼šæç¤º ts(2322) ç±»å‹é”™è¯¯ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  enum A &#123;</span><br><span class="line">    one</span><br><span class="line">  &#125;</span><br><span class="line">  enum B &#123;</span><br><span class="line">    one</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> a: A;</span><br><span class="line">  <span class="keyword">let</span> b: B;</span><br><span class="line">  a = b; <span class="comment">// ts(2322)</span></span><br><span class="line">  b = a; <span class="comment">// ts(2322)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="ç±»å‹å…¼å®¹æ€§"   >
          <a href="#ç±»å‹å…¼å®¹æ€§" class="heading-link"><i class="fas fa-link"></i></a>ç±»å‹å…¼å®¹æ€§</h2>
      <p>é™¤å»å‰è¾¹æåˆ°çš„æ‰€æœ‰ç‰¹ä¾‹ï¼ŒTypeScript é‡Œç±»å‹çš„å…¼å®¹æ€§æ˜¯åŸºäºç»“æ„åŒ–å­ç±»å‹çš„ä¸€èˆ¬åŸåˆ™è¿›è¡Œåˆ¤å®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç»“æ„åŒ–ç±»å‹å’Œå­ç±»å‹ä¸¤ä¸ªæ–¹é¢æ¥äº†è§£è¿™ä¸ªä¸€èˆ¬åŸåˆ™ã€‚</p>

        <h3 id="å­ç±»å‹"   >
          <a href="#å­ç±»å‹" class="heading-link"><i class="fas fa-link"></i></a>å­ç±»å‹</h3>
      <p>é¦–å…ˆæˆ‘ä»¬ä»å­ç±»å‹è§’åº¦æ¥çœ‹ï¼Œå³æ‰€æœ‰çš„å­ç±»å‹ä¸å®ƒçš„çˆ¶ç±»å‹å…¼å®¹ï¼Œå¦‚ç¤ºä¾‹é‡Œæˆ‘ä»¬å¯ä»¥æŠŠç±»å‹æ˜¯æ•°å­—å­—é¢é‡ç±»å‹ one èµ‹å€¼ç»™æ•°å­—ç±»å‹çš„ numã€æˆ‘ä»¬å¯ä»¥æŠŠå­æ¥å£ç±»å‹çš„å˜é‡ èµ‹å€¼ç»™ Parã€æˆ‘ä»¬å¯ä»¥æŠŠå­ç±»å®ä¾‹ ChildInst èµ‹å€¼ç»™ ParInstï¼›æˆå‘˜ç±»å‹å…¼å®¹å®ƒæ‰€å±çš„ç±»å‹é›†åˆï¼ˆå…¶å®è”åˆç±»å‹å’Œæšä¸¾éƒ½ç®—æ˜¯ç±»å‹é›†åˆï¼Œæˆ‘ä»¬è¿™é‡Œä¸»è¦è¯´çš„æ˜¯è”åˆç±»å‹ï¼‰ï¼Œå¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ one èµ‹å€¼ç»™åŒ…å«å­—é¢ç±»å‹ 1 çš„è”åˆç±»å‹ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">const</span> one = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> num: number = one; <span class="comment">// okinterface IPar &#123;</span></span><br><span class="line">    name: string;</span><br><span class="line">  &#125;</span><br><span class="line">  interface IChild extends IPar &#123;</span><br><span class="line">    id: number;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> Par: IPar;</span><br><span class="line">  <span class="keyword">let</span> Child: IChild;</span><br><span class="line">  Par = Child; <span class="comment">// okclass CPar &#123;</span></span><br><span class="line">    cname = <span class="string">''</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">CChild</span> <span class="keyword">extends</span> <span class="title">CPar</span> </span>&#123;</span><br><span class="line">    cid = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> ParInst: CPar;</span><br><span class="line">  <span class="keyword">let</span> ChildInst: CChild;</span><br><span class="line">  ParInst = ChildInst; <span class="comment">// ok</span></span><br><span class="line"><span class="keyword">let</span> mixedNum: <span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span> = one; <span class="comment">// ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>ä¸¾ä¸€åä¸‰ï¼Œç”±å­ç±»å‹ç»„æˆçš„è”åˆç±»å‹ä¹Ÿæ˜¯å¯ä»¥å…¼å®¹å®ƒä»¬çˆ¶ç±»å‹ç»„æˆçš„è”åˆç±»å‹ï¼Œå¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œå› ä¸º IChild æ˜¯ IPar çš„å­ç±»ã€CChild æ˜¯ CPar çš„å­ç±»ï¼Œæ‰€ä»¥ IChild | CChild ä¹Ÿæ˜¯ IPar | CPar çš„å­ç±»ï¼Œè¿›è€Œ ICChild å¯ä»¥èµ‹å€¼ç»™ ICParï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ICPar: IPar | CPar;</span><br><span class="line"><span class="keyword">let</span> ICChild: IChild | CChild;</span><br><span class="line">ICPar = ICChild; <span class="comment">// ok</span></span><br></pre></td></tr></table></div></figure>


        <h3 id="ç»“æ„ç±»å‹"   >
          <a href="#ç»“æ„ç±»å‹" class="heading-link"><i class="fas fa-link"></i></a>ç»“æ„ç±»å‹</h3>
      <p>ç±»å‹å…¼å®¹æ€§å‡†åˆ™å¦ä¸€æ–¹é¢æ˜¯ç»“æ„ç±»å‹ï¼Œå³æ˜¯è¯´å¦‚æœä¸¤ä¸ªç±»å‹çš„ç»“æ„ä¸€è‡´ï¼Œåˆ™å®ƒä»¬æ˜¯äº’ç›¸å…¼å®¹çš„ï¼›æ¯”å¦‚æ‹¥æœ‰ç›¸åŒç±»å‹çš„å±æ€§ã€æ–¹æ³•çš„æ¥å£ç±»å‹æˆ–è€…ç±»ï¼Œåˆ™å¯ä»¥äº’ç›¸èµ‹å€¼ï¼Œå¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œå› ä¸º ç±» C1ã€C2ã€æ¥å£ I1ã€I2 å®ƒä»¬çš„ç»“æ„å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥å¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ C2 ç±»çš„å®ä¾‹ InstC2 èµ‹å€¼ç»™ C1 ç±»çš„å®ä¾‹ Inst1ã€æŠŠ I2 ç±»å‹çš„å˜é‡ O2 èµ‹å€¼ç»™ I1 ç±»å‹çš„ O1ï¼›ç”šè‡³ï¼Œå¦‚ç¤ºä¾‹æ‰€ç¤ºï¼Œå¯ä»¥æŠŠ I1 ç±»å‹çš„å˜é‡ O1 èµ‹å€¼ç»™ C1 ç±»çš„å®ä¾‹ã€æŠŠ C2 ç±»çš„ç¤ºä¾‹èµ‹å€¼ç»™ I2 ç±»å‹çš„å˜é‡ O2ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">C1</span> </span>&#123;</span><br><span class="line">    name = <span class="string">'1'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">C2</span> </span>&#123;</span><br><span class="line">    name = <span class="string">'2'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  interface I1 &#123;</span><br><span class="line">    name: string;</span><br><span class="line">  &#125;</span><br><span class="line">  interface I2 &#123;</span><br><span class="line">    name: string;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> InstC1: C1;</span><br><span class="line">  <span class="keyword">let</span> InstC2: C2;</span><br><span class="line">  <span class="keyword">let</span> O1: I1;</span><br><span class="line">  <span class="keyword">let</span> O2: I2;</span><br><span class="line">  InstC1 = InstC2; <span class="comment">// ok</span></span><br><span class="line">  O1 = O2; <span class="comment">// ok</span></span><br><span class="line">  InstC1 = O1; <span class="comment">// ok</span></span><br><span class="line">  O2 = InstC2; <span class="comment">// ok</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/04/24/%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BB%A3%E7%A0%81%E6%B2%A1%E6%9C%89%E6%8C%89%E7%BC%96%E5%86%99%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C/">ä¸ºä»€ä¹ˆä»£ç æ²¡æœ‰æŒ‰ç¼–å†™é¡ºåºæ‰§è¡Œ</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-04-24</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>å‰ç«¯å·¥ç¨‹å¸ˆç®—æ˜¯æœ€å¹¸è¿çš„è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œå› ä¸ºä»ä¸€å¼€å§‹å°±å¯ä»¥æ¥è§¦åˆ°â€œå¼‚æ­¥â€è¿™ç§é«˜çº§ç‰¹æ€§ï¼Œæ¯”å¦‚ DOM äº‹ä»¶ã€AJAX è¯·æ±‚åŠå®šæ—¶å™¨ï¼›åŒæ—¶ä¹Ÿæ˜¯æœ€ä¸å¹¸çš„è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œå› ä¸ºå…¥é—¨ JavaScript çš„æ—¶å€™å°±è¦ä¹ æƒ¯å¼‚æ­¥è¿™ç§é«˜éš¾åº¦çš„å¼€å‘æ–¹å¼ï¼Œå¼‚æ­¥ç»å¸¸ä¼šå¯¼è‡´è¾“å‡ºçš„ç»“æœä¸æˆ‘ä»¬çš„é¢„æœŸä¸ä¸€è‡´ã€‚</p>

        <h4 id="å¼‚æ­¥å’ŒåŒæ­¥"   >
          <a href="#å¼‚æ­¥å’ŒåŒæ­¥" class="heading-link"><i class="fas fa-link"></i></a>å¼‚æ­¥å’ŒåŒæ­¥</h4>
      <p>è¿™ä¸¤ä¸ªæ¦‚å¿µå¤§å®¶åº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰å•¦ï¼Œç®€å•è§£é‡Šä¸€ä¸‹ï¼Œè¦æ¯”è¾ƒåŒæ­¥å’Œå¼‚æ­¥ï¼Œå¯ä»¥å°†è°ƒç”¨å‡½æ•°çš„è¿‡ç¨‹åˆ†æˆä¸¤éƒ¨åˆ†ï¼šæ‰§è¡Œæ“ä½œå’Œè¿”å›ç»“æœã€‚ç¨‹åºåœ¨åŒæ­¥è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œä¼šç«‹å³æ‰§è¡Œæ“ä½œå¹¶ç­‰å¾…å¾—åˆ°è¿”å›ç»“æœåå†ç»§ç»­è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´åŒæ­¥æ‰§è¡Œæ˜¯é˜»å¡çš„ã€‚è€Œå¼‚æ­¥ä¼šå°†æ“ä½œå’Œç»“æœåœ¨æ—¶é—´ä¸Šåˆ†éš”å¼€æ¥ï¼Œåœ¨å½“ä¸‹æ‰§è¡Œæ“ä½œï¼Œåœ¨æœªæ¥æŸä¸ªæ—¶åˆ»è¿”å›ç»“æœï¼Œåœ¨è¿™ä¸ªç­‰å¾…è¿”å›ç»“æœçš„è¿‡ç¨‹ä¸­ï¼Œç¨‹åºå°†ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚ä¹Ÿå°±æ˜¯è¯´å¼‚æ­¥æ‰§è¡Œæ˜¯éé˜»å¡çš„ã€‚è¿™é‡Œå°±ä¸ä¸¾ğŸŒ°å•¦ã€‚</p>

        <h4 id="å¼‚æ­¥ä¸å›è°ƒ"   >
          <a href="#å¼‚æ­¥ä¸å›è°ƒ" class="heading-link"><i class="fas fa-link"></i></a>å¼‚æ­¥ä¸å›è°ƒ</h4>
      <p>æˆ‘ä»¬ç»å¸¸è°ƒç”¨ JavaScript çš„å¼‚æ­¥å‡½æ•°å¯èƒ½ä¼šè®¤ä¸ºï¼šå¼‚æ­¥æ“ä½œéƒ½é‡‡ç”¨å›è°ƒå‡½æ•°çš„å½¢å¼ã€‚æ¯•ç«Ÿä»æµè§ˆå™¨ç«¯çš„ DOM äº‹ä»¶ã€AJAX è¯·æ±‚ã€å®šæ—¶å™¨åˆ° Node.js ç«¯çš„æ–‡ä»¶è¯»å†™ã€å¤šè¿›ç¨‹ï¼Œéƒ½æ˜¯é‡‡ç”¨çš„å›è°ƒå½¢å¼ã€‚é‚£ä¹ˆè¿˜ä¼šæœ‰å…¶ä»–caseå˜›ï¼Œä¸ŠğŸŒ°ã€‚<br>ä¸‹é¢æ˜¯ä¸€æ®µç®€å•çš„ä»£ç ï¼Œå®šä¹‰äº†ä¸€ä¸ª JSON å¯¹è±¡ aï¼Œç„¶åæŠŠå®ƒæ‰“å°åˆ°æ§åˆ¶å°ï¼Œæœ€åå†å°†å¯¹è±¡ a çš„ couter.index å±æ€§å€¼è‡ªå¢ 1ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  counter: &#123;</span><br><span class="line">    index: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log( a ); <span class="comment">// ?</span></span><br><span class="line">a.counter.index++;</span><br></pre></td></tr></table></div></figure>
<p>æˆ‘ä»¬åœ¨æ§åˆ¶å°é‡Œçœ‹ä¸€ä¸‹ï¼Œç»“æœå¯èƒ½å’Œæˆ‘ä»¬çš„é¢„æœŸä¸ä¸€è‡´ï¼Œè¾“å‡ºäº†ä¸€ä¸ªJSON å¯¹è±¡ï¼š{conter:{index: 2}}ã€‚åŸå› åœ¨äºæµè§ˆå™¨åœ¨è¿è¡Œä»£ç çš„æ—¶å€™ï¼ŒæŠŠæ§åˆ¶å°æ‰“å°è¿™ç§æ¶‰åŠ I/O çš„æ“ä½œè¿›è¡Œäº†å»¶è¿Ÿæ‰§è¡Œã€‚å¯èƒ½æœ‰äººä¼šæ¨æµ‹æ˜¯ä¸æ˜¯æ§åˆ¶å°æ‰“å°çš„åªæ˜¯å°†å¯¹è±¡ a è¿›è¡Œäº†ç±»ä¼¼â€œæµ…æ‹·è´â€çš„æ“ä½œï¼Œå¦å®šè¿™ç§çŒœæƒ³å¾ˆç®€å•ï¼Œæ­¤æ—¶å†æ‰§è¡Œä¸€æ¬¡è‡ªå¢æ“ä½œï¼Œå°±ä¼šå‘ç°è¢«æ‰“å°çš„å¯¹è±¡å€¼å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ã€‚<br>æ—¢ç„¶å¹¶éæ‰€æœ‰å¼‚æ­¥éƒ½å›è°ƒï¼Œé‚£ä¹ˆåè¿‡æ¥ï¼Œæ˜¯å¦æ‰€æœ‰å›è°ƒå‡½æ•°éƒ½æ˜¯å¼‚æ­¥æ‰§è¡Œçš„å‘¢ï¼Ÿç­”æ¡ˆä¹Ÿæ˜¯å¦å®šçš„ã€‚æ¯”å¦‚æ•°ç»„åŸå‹å‡½æ•° forEachï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯ this æŒ‡å‘çš„å¯¹è±¡ï¼Œè¿™é‡Œçš„å›è°ƒå°±æ˜¯åŒæ­¥çš„ã€‚</p>

        <h4 id="å¼‚æ­¥åŸç†"   >
          <a href="#å¼‚æ­¥åŸç†" class="heading-link"><i class="fas fa-link"></i></a>å¼‚æ­¥åŸç†</h4>
      <p>å›é¡¾äº†å¼‚æ­¥çš„åŸºç¡€æ¦‚å¿µï¼Œä¸‹é¢å°±æ¥æ·±å…¥è®²è§£å¼‚æ­¥çš„åŸç†ã€‚</p>

        <h5 id="äº‹ä»¶å¾ªç¯"   >
          <a href="#äº‹ä»¶å¾ªç¯" class="heading-link"><i class="fas fa-link"></i></a>äº‹ä»¶å¾ªç¯</h5>
      <p>å¯¹äºå¤§å¤šæ•°è¯­è¨€è€Œè¨€ï¼Œå®ç°å¼‚æ­¥ä¼šé€šè¿‡å¯åŠ¨é¢å¤–çš„è¿›ç¨‹ã€çº¿ç¨‹æˆ–åç¨‹æ¥å®ç°ï¼Œè€Œæˆ‘ä»¬åœ¨å‰é¢å·²ç»æåˆ°è¿‡ï¼ŒJavaScript æ˜¯å•çº¿ç¨‹çš„ã€‚ä¸ºä»€ä¹ˆå•çº¿ç¨‹è¿˜èƒ½å®ç°å¼‚æ­¥å‘¢ï¼Ÿå…¶å®ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„é»‘é­”æ³•ï¼Œåªæ˜¯æŠŠä¸€äº›æ“ä½œäº¤ç»™äº†å…¶ä»–çº¿ç¨‹å¤„ç†ï¼Œç„¶åé‡‡ç”¨äº†ä¸€ç§ç§°ä¹‹ä¸ºâ€œäº‹ä»¶å¾ªç¯â€ï¼ˆä¹Ÿç§°â€œäº‹ä»¶è½®è¯¢â€ï¼‰çš„æœºåˆ¶æ¥å¤„ç†è¿”å›ç»“æœã€‚<br>ä¸‹é¢æˆ‘ä»¬ç”¨ä¸€æ®µç®€åŒ–çš„ä»£ç ï¼Œæ¥æè¿°äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚<br>æ•°ç»„ eventLoop è¡¨ç¤ºäº‹ä»¶é˜Ÿåˆ—ï¼ˆä¹Ÿæœ‰ç§°ä½œâ€œä»»åŠ¡é˜Ÿåˆ—â€ï¼‰ï¼Œç”¨æ¥å­˜æ”¾éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡äº‹ä»¶ï¼ˆå¯ä»¥ç†è§£ä¸ºå›è°ƒå‡½æ•°ï¼‰ï¼Œå¯¹è±¡ event å˜é‡è¡¨ç¤ºå½“å‰éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡äº‹ä»¶ã€‚ç”¨ä¸€ä¸ªæ°¸ä¸åœæ­¢çš„ while å¾ªç¯æ¥è¡¨ç¤ºäº‹ä»¶å¾ªç¯ï¼Œæ¯ä¸€æ¬¡å¾ªç¯ç§°ä¸ºä¸€ä¸ª tickã€‚å¯¹æ¯ä¸ª tick è€Œè¨€ï¼Œå¦‚æœåœ¨é˜Ÿåˆ—ä¸­æœ‰ç­‰å¾…äº‹ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šä»é˜Ÿåˆ—ä¸­è·å–ä¸€ä¸ªäº‹ä»¶å¹¶æ‰§è¡Œï¼Œè¿™äº›äº‹ä»¶é€šå¸¸æ˜¯å›è°ƒå‡½æ•°çš„å½¢å¼ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eventLoop = []; <span class="comment">// äº‹ä»¶é˜Ÿåˆ—ï¼Œå…ˆè¿›å…ˆå‡º</span></span><br><span class="line"><span class="keyword">var</span> event; <span class="comment">// äº‹ä»¶æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="comment">// ä¸€æ¬¡tick</span></span><br><span class="line">  <span class="keyword">if</span> (eventLoop.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—ä¸­å–å‡ºå›è°ƒå‡½æ•°</span></span><br><span class="line">    event = eventLoop.shift();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      event();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">      reportError(err);Â </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>é‚£ä¹ˆè¿™ä¸ªäº‹ä»¶é˜Ÿåˆ—é‡Œçš„äº‹ä»¶æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿä»¥ AJAX è¯·æ±‚ä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬å‘å‡ºä¸€ä¸ª AJAX è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†è¯·æ±‚ä»»åŠ¡åˆ†æ´¾ç»™ç½‘ç»œçº¿ç¨‹æ¥è¿›è¡Œå¤„ç†ï¼Œå½“å¯¹åº”çš„ç½‘ç»œçº¿ç¨‹æ‹¿åˆ°è¿”å›çš„æ•°æ®ä¹‹åï¼Œå°±ä¼šæŠŠå›è°ƒå‡½æ•°æ’å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚setTimeout å’Œ setInterval ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ setTimeout çš„æ—¶å€™å¹¶ä¸æ˜¯ç›´æ¥æŠŠå›è°ƒå‡½æ•°æ”¾å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚å®ƒæ‰€åšçš„æ˜¯äº¤ç»™å®šæ—¶å™¨çº¿ç¨‹æ¥å¤„ç†ï¼Œå½“å®šæ—¶å™¨åˆ°æ—¶åï¼Œå†æŠŠå›è°ƒå‡½æ•°æ”¾åœ¨äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œè¿™æ ·ï¼Œåœ¨æœªæ¥çš„æŸè½® tick ä¸­è·å–å¹¶æ‰§è¡Œè¿™ä¸ªå›è°ƒå‡½æ•°ã€‚è¿™ä¹ˆåšæœ‰ä¸€ä¸ªéšæ€§çš„é—®é¢˜ï¼Œå¦‚æœäº‹ä»¶é˜Ÿåˆ—ä¸­å·²ç»æœ‰å…¶ä»–äº‹ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªå›è°ƒå°±ä¼šæ’é˜Ÿç­‰å¾…ã€‚æ‰€ä»¥è¯´ setTimeout/setInterval å®šæ—¶å™¨çš„ç²¾åº¦å¹¶ä¸é«˜ã€‚å‡†ç¡®åœ°è¯´ï¼Œå®ƒåªèƒ½ç¡®ä¿å›è°ƒå‡½æ•°ä¸ä¼šåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”ä¹‹å‰è¿è¡Œï¼Œä½†å¯èƒ½ä¼šåœ¨é‚£ä¸ªæ—¶åˆ»è¿è¡Œï¼Œä¹Ÿå¯èƒ½åœ¨é‚£ä¹‹åè¿è¡Œï¼Œè¿™å°±è¦æ ¹æ®äº‹ä»¶é˜Ÿåˆ—çš„çŠ¶æ€è€Œå®šã€‚</p>

        <h5 id="äº‹ä»¶é˜Ÿåˆ—"   >
          <a href="#äº‹ä»¶é˜Ÿåˆ—" class="heading-link"><i class="fas fa-link"></i></a>äº‹ä»¶é˜Ÿåˆ—</h5>
      <p>åœ¨è®²è¿° setTimeout/setInterval åŸç†çš„æ—¶å€™ä¹Ÿæš´éœ²äº†äº‹ä»¶é˜Ÿåˆ—çš„ä¸€ä¸ªç¼ºé™·ï¼šäº‹ä»¶é˜Ÿåˆ—æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œï¼Œé‚£ä¹ˆå¦‚æœé˜Ÿåˆ—è¾ƒé•¿æ—¶ï¼Œæ’åœ¨åé¢çš„äº‹ä»¶å³ä½¿è¾ƒä¸ºâ€œç´§æ€¥â€ï¼Œä¹Ÿå¾—éœ€è¦ç­‰å¾…å‰é¢çš„ä»»åŠ¡å…ˆæ‰§è¡Œå®Œæˆã€‚JavaScript è§£å†³è¿™ä¸ªé—®é¢˜çš„æ€è·¯å°±æ˜¯ï¼šè®¾ç½®å¤šä¸ªé˜Ÿåˆ—ï¼ŒæŒ‰ç…§ä¼˜å…ˆçº§æ¥æ‰§è¡Œã€‚<br>ä¸‹é¢è¿™æ®µä»£ç å¯ä»¥éªŒè¯ JavaScript å†…éƒ¨æ‹¥æœ‰ä¼˜å…ˆçº§ä¸åŒçš„ 2 ä¸ªé˜Ÿåˆ—ï¼Œæˆ‘ä»¬æš‚æ—¶ç§°ä¸ºçº¢è‰²é˜Ÿåˆ—å’Œç»¿è‰²é˜Ÿåˆ—ï¼Œå…¶ä¸­çº¢è‰²é˜Ÿåˆ—ä¼˜å…ˆçº§é«˜äºç»¿è‰²é˜Ÿåˆ—ã€‚è¿™æ®µä»£ç å®šä¹‰äº† 4 ä¸ªå¼‚æ­¥å‡½æ•° f1ã€f2ã€f3ã€f4ï¼Œå…¶ä¸­ï¼šå‡½æ•° f1 é€šè¿‡å®šæ—¶å™¨ setTimeout å‘ç»¿è‰²é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªæ§åˆ¶å°æ‰“å°ä»»åŠ¡ï¼Œè¾“å‡ºæ•°å­— 1ï¼›å‡½æ•° f2 é€šè¿‡ Promise å‘çº¢è‰²é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªæ§åˆ¶å°æ‰“å°ä»»åŠ¡ï¼Œè¾“å‡ºæ•°å­— 2ï¼›å‡½æ•° f3 é€šè¿‡å®šæ—¶å™¨ setTimeout å‘ç»¿è‰²é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°ä¼šè°ƒç”¨æ§åˆ¶å°æ‰“å°æ•°å­— 3ï¼Œå¹¶ä¸”è°ƒç”¨å‡½æ•° f2ï¼›å‡½æ•° f4 é€šè¿‡ Promise å‘çº¢è‰²é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°ä¼šè°ƒç”¨æ§åˆ¶å°æ‰“å°æ•°å­— 4ï¼Œå¹¶ä¸”è°ƒç”¨å‡½æ•° f1ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">Â  setTimeout(<span class="built_in">console</span>.log.bind(<span class="literal">null</span>,<span class="number">1</span>), <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">Â  <span class="built_in">Promise</span>.resolve().then(<span class="built_in">console</span>.log.bind(<span class="literal">null</span>,<span class="number">2</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f3</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">Â  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">Â  Â  <span class="built_in">console</span>.log(<span class="number">3</span>)</span><br><span class="line">Â  Â  f2()</span><br><span class="line">Â  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f4</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">Â  <span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">Â  Â  <span class="built_in">console</span>.log(<span class="number">4</span>)</span><br><span class="line">Â  Â  f1()</span><br><span class="line">Â  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">f3()</span><br><span class="line">f4()</span><br></pre></td></tr></table></div></figure>
<p>å½“è°ƒç”¨å‡½æ•° f3 å’Œå‡½æ•° f4 ä¹‹åï¼Œç»¿è‰²é˜Ÿåˆ—å’Œçº¢è‰²é˜Ÿåˆ—éƒ½ä¼šè¢«æ’å…¥ä¸€ä¸ªåŒ¿åå›è°ƒå‡½æ•°ã€‚ç¬¬ 1 æ¬¡ tickï¼Œç”±äºçº¢è‰²é˜Ÿåˆ—ä¼˜å…ˆçº§é«˜ï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œçº¢è‰²åŒ¿åå‡½æ•°ï¼Œæ§åˆ¶å°æ‰“å°æ•°å­— 4ï¼Œç„¶åè°ƒç”¨å‡½æ•° f1ï¼Œå‘ç»¿è‰²é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªæ‰“å°å‡½æ•°ï¼›ç¬¬ 2 æ¬¡ tickï¼ŒæŒ‰ç…§å…ˆè¿›å…ˆå‡ºåŸåˆ™ï¼Œæ­¤æ—¶è°ƒç”¨åŒ¿åå‡½æ•°æ‰“å°æ•°å­— 3ï¼Œå¹¶è°ƒç”¨å‡½æ•° f2ï¼Œå‘çº¢è‰²é˜Ÿåˆ—ä¸­æ’å…¥ä¸€ä¸ªæ‰“å°å‡½æ•°ï¼›ç¬¬ 3 æ¬¡ tickï¼Œè°ƒç”¨çº¢è‰²é˜Ÿåˆ—ä¸­çš„æ‰“å°å‡½æ•°ï¼Œæ§åˆ¶å°æ‰“å°æ•°å­— 2ï¼›ç¬¬ 4 æ¬¡ tickï¼Œè°ƒç”¨ç»¿è‰²é˜Ÿåˆ—ä¸­çš„æ‰“å°å‡½æ•°ï¼Œæ§åˆ¶å°æ‰“å°æ•°å­— 1ã€‚<br>å…³äºçº¢è‰²é˜Ÿåˆ—å’Œç»¿è‰²é˜Ÿåˆ—ï¼Œä¸€èˆ¬ç§°ä¸ºâ€œå®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆMacro Task Queueï¼‰â€å’Œâ€œå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆMicro Task Queueï¼‰â€ï¼Œä¸åŒé˜Ÿåˆ—ä¼˜å…ˆçº§ä¸åŒï¼Œæ¯æ¬¡äº‹ä»¶å¾ªç¯æ—¶ä¼šä»ä¼˜å…ˆçº§é«˜çš„é˜Ÿåˆ—ä¸­è·å–äº‹ä»¶ï¼Œåªæœ‰å½“ä¼˜å…ˆçº§é«˜çš„é˜Ÿåˆ—ä¸ºç©ºæ—¶æ‰ä¼šä»ä¼˜å…ˆçº§ä½çš„é˜Ÿåˆ—ä¸­è·å–äº‹ä»¶ï¼ŒåŒçº§é˜Ÿåˆ—ä¹‹é—´çš„äº‹ä»¶ä¸å­˜åœ¨ä¼˜å…ˆçº§ï¼Œåªéµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŸåˆ™ã€‚</p>
<p>å¸¸è§çš„å¼‚æ­¥å‡½æ•°ä¼˜å…ˆçº§å¦‚ä¸‹ï¼Œä»ä¸Šåˆ°ä¸‹ä¼˜å…ˆçº§é€å±‚é™ä½ï¼š</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">process.nextTick(Node.js) &gt; </span><br><span class="line">MutationObserver(æµè§ˆå™¨)/promise.then(<span class="keyword">catch</span>ã€finnally)&gt;</span><br><span class="line">setImmediate(IE) &gt; </span><br><span class="line">setTimeout/setIntervalrequestAnimationFrame &gt;</span><br><span class="line">å…¶ä»– I/O æ“ä½œ / æµè§ˆå™¨ DOM äº‹ä»¶</span><br></pre></td></tr></table></div></figure>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/03/27/JSX%E5%A6%82%E4%BD%95%E5%8F%98%E6%88%90DOM/">JSXå¦‚ä½•å˜æˆDOM</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-03-27</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>å…¥é—¨Reactçš„æ—¶å€™ï¼Œæˆ‘ä»¬äº†è§£äº†ç¥å¥‡çš„JSXè¯­æ³•ï¼Œå½“æ—¶çš„å®˜æ–¹æ˜¯å»ºè®®ä½¿ç”¨JSXï¼Œä½œä¸ºå°ç™½çš„æˆ‘å½“ç„¶æ˜¯ä¹–ä¹–å¬è¯ã€‚æƒ³å¿…ç°åœ¨å¤§å®¶éƒ½æ—©å·²ç»ä¹ æƒ¯ä½¿ç”¨JSXï¼Œæˆ‘ä»¬ä»Šå¤©æ¥äº†è§£ä¸€ä¸‹å®ƒæ˜¯å¦‚ä½•æˆä¸ºDOMçš„ã€‚</p>

        <h2 id="JSXçš„æœ¬è´¨"   >
          <a href="#JSXçš„æœ¬è´¨" class="heading-link"><i class="fas fa-link"></i></a>JSXçš„æœ¬è´¨</h2>
      <p>å®˜æ–¹æè¿°JSXæ˜¯JavaScriptçš„æ‰©å±•è¯­æ³•ï¼Œå®ƒå……åˆ†å…·å¤‡JavaScriptçš„èƒ½åŠ›ï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ã€‚è¿™æ—¶å€™æˆ‘èƒ½æƒ³åˆ°çš„å°±æ˜¯å®˜æ–¹éœ¸éœ¸ç»™å‡ºçš„ä¸€å¥è¯ï¼ŒJSXä¼šè¢«ç¼–è¯‘æˆReact.createElement(),å®ƒä¼šè¿”å›ä¸€ä¸ªå«åšâ€™React Elementâ€™çš„JSå¯¹è±¡ã€‚é¦–å…ˆç¼–è¯‘è¿™ä¸ªåŠ¨ä½œï¼Œå®ƒæ˜¯ç”±Babelæ¥å®Œæˆçš„ï¼Œæˆ‘ä»¬çŸ¥é“Babelçš„ä¸»è¦åŠŸèƒ½æ˜¯å°†ECMAScript2015+ç‰ˆæœ¬çš„ä»£ç è½¬æ¢æˆå‘åå…¼å®¹çš„JavaScriptè¯­æ³•ï¼Œä»è€Œèƒ½è¿è¡Œåœ¨å½“å‰çš„æµè§ˆå™¨ä¸­ã€‚å…¶å®ï¼ŒJSXä¹Ÿæ˜¯ç”±Babelæ¥è½¬æ¢ä¸ºJavascriptä»£ç çš„ã€‚<br><img src='/images/Babelè½¬æ¢JSX.png'></p>
<p>æˆ‘éšä¾¿æ‰¾äº†ä¸€æ®µé¡¹ç›®é‡Œçš„ç®€å•ç»„ä»¶çš„JSXä»£ç æ”¾åœ¨Babelå®˜ç½‘ä¸Šï¼Œå®ƒä¼šå°†å…¶è½¬æ¢æˆReact.createElementçš„è°ƒç”¨ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„JSXæ ‡ç­¾éƒ½è¢«è½¬æ¢æˆäº†React.createElementè°ƒç”¨ï¼Œå¤§å®¶æ˜æ˜¾èƒ½æ„Ÿå—åˆ°ï¼ŒJSXç›¸å¯¹è€Œè¨€ä¸ä»…é˜…è¯»èµ·æ¥å‹å¥½ï¼Œå¼€å‘èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼ˆ2333è¿™ä¸ªæ¯”è¾ƒå…³é”®ï¼‰ã€‚å°ç»“ä¸€ä¸‹ï¼ŒJSXæœ¬è´¨æ˜¯React.createElementè¿™ä¸ªJavaScriptè°ƒç”¨çš„è¯­æ³•ç³–ï¼Œå®ƒå…è®¸å¼€å‘è€…ç”¨è¾ƒç†Ÿæ‚‰çš„ç±»HTMLæ ‡ç­¾è¯­æ³•æ¥åˆ›å»ºè™šæ‹ŸDOMï¼Œæå‡äº†å¼€å‘æ•ˆç‡ï¼Œä¹Ÿé™ä½äº†å­¦ä¹ æˆæœ¬ã€‚</p>

        <h2 id="è¯»ä¸€è¯»createElementæºç "   >
          <a href="#è¯»ä¸€è¯»createElementæºç " class="heading-link"><i class="fas fa-link"></i></a>è¯»ä¸€è¯»createElementæºç </h2>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params">type, config, children</span>)</span></span><br></pre></td></tr></table></div></figure>
<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸‰ä¸ªå…¥å‚ï¼Œtypeæ˜¯èŠ‚ç‚¹ç±»å‹ï¼Œå¯ä»¥æ˜¯divã€spanè¿™æ ·çš„æ ‡å‡†HTMLæ ‡ç­¾å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯Reactç»„ä»¶ç±»å‹ï¼›configæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨äº†ç»„ä»¶çš„å±æ€§ï¼›childrenè®°å½•çš„æ˜¯å­èŠ‚ç‚¹ã€å­å…ƒç´ å¯¹è±¡ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//propNameç”¨äºå­˜å‚¨å…ƒç´ å±æ€§ï¼Œpropsç”¨äºå­˜å‚¨å±æ€§çš„é”®å€¼å¯¹é›†åˆ</span></span><br><span class="line"><span class="keyword">let</span> propName;</span><br><span class="line"><span class="keyword">const</span> props = &#123; &#125;;</span><br><span class="line"><span class="keyword">let</span> key = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> ref = <span class="literal">null</span>; </span><br><span class="line"><span class="keyword">let</span> self = <span class="literal">null</span>; </span><br><span class="line"><span class="keyword">let</span> source = <span class="literal">null</span>; </span><br><span class="line"><span class="comment">// keyã€refã€selfã€source å‡ä¸º React å…ƒç´ çš„å±æ€§</span></span><br><span class="line"><span class="keyword">if</span> (hasValidRef(config)) &#123;</span><br><span class="line">  ref = config.ref;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (hasValidKey(config)) &#123;</span><br><span class="line">  key = <span class="string">''</span> + config.key; </span><br><span class="line">&#125;</span><br><span class="line">self = config.__self === <span class="literal">undefined</span> ? <span class="literal">null</span> : config.__self;</span><br><span class="line">source = config.__source === <span class="literal">undefined</span> ? <span class="literal">null</span> : config.__source;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥ä¸‹æ¥å°†ç¬¦åˆçš„configé‡Œçš„å±æ€§æ”¾å…¥propsä¸­</span></span><br><span class="line"><span class="keyword">for</span> (propsName <span class="keyword">in</span> config) &#123;</span><br><span class="line">  <span class="keyword">if</span> (hasOwnProperty.call(config, propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName)) &#123;</span><br><span class="line">    props[propName] = config[propName];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//childrenLengthæ˜¯åœ¨è·å–å­å…ƒç´ ï¼Œå› æ­¤å‡å»çš„ä¸¤é¡¹æ˜¯æŒ‡typeå’Œconfigä¸¤ä¸ªå‚æ•°å ç”¨çš„é•¿åº¦</span></span><br><span class="line"><span class="keyword">const</span> childrenLength = <span class="built_in">arguments</span>.length - <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123; </span><br><span class="line">    props.children = children; </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123; </span><br><span class="line">  <span class="comment">//å¤„ç†å¤šä¸ªå­å…ƒç´ </span></span><br><span class="line">  <span class="keyword">const</span> childArray = <span class="built_in">Array</span>(childrenLength); </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; childrenLength; i++) &#123; </span><br><span class="line">    childArray[i] = <span class="built_in">arguments</span>[i + <span class="number">2</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//å°†childrenèµ‹å€¼ç»™propsçš„childrenå±æ€§</span></span><br><span class="line">  props.children = childArray; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ«å¿˜äº†å¤„ç†èŠ‚ç‚¹çš„é»˜è®¤å±æ€§</span></span><br><span class="line"><span class="keyword">if</span> (type &amp;&amp; type.defaultProps) &#123;</span><br><span class="line">  <span class="keyword">const</span> defaultProps = type.defaultProps;</span><br><span class="line">  <span class="keyword">for</span> (propName <span class="keyword">in</span> defaultProps) &#123; </span><br><span class="line">    <span class="keyword">if</span> (props[propName] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      props[propName] = defaultProps[propName];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ€åè¿”å›è°ƒç”¨ReactElementæ‰§è¡Œæ–¹æ³•ï¼Œä¼ å…¥å¤„ç†åçš„å‚æ•°</span></span><br><span class="line"><span class="keyword">return</span> ReactElement(</span><br><span class="line">  type,</span><br><span class="line">  key,</span><br><span class="line">  ref,</span><br><span class="line">  self,</span><br><span class="line">  source,</span><br><span class="line">  ReactCurrentOwner.current,</span><br><span class="line">  props,</span><br><span class="line">);</span><br></pre></td></tr></table></div></figure>
<p>çœ‹å®Œå¤§å®¶ä¼šä¸ä¼šæœ‰äº›å¤±æœ›ï¼ŒåŸæ¥createElementå¥½åƒä¹Ÿæ²¡åšå•¥å“ˆå“ˆå“ˆï¼Œå®ƒå¹¶æ²¡æœ‰æ¶‰åŠåˆ°çœŸå®çš„DOMã€‚å…¶å®å®ƒåªæ˜¯æ¥å—ç›¸å¯¹ç®€å•çš„å‚æ•°ç„¶ååšä¸€æ¬¡æ•°æ®å¤„ç†ï¼Œæœ€åè°ƒç”¨ReactElementæ¥åˆ›å»ºå…ƒç´ ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥ç»§ç»­åº·åº·ReactElementçš„æºç ã€‚</p>

        <h2 id="è¯»ä¸€è¯»ReactElementæºç -è®¤è¯†ä¸€ä¸‹è™šæ‹ŸDOM"   >
          <a href="#è¯»ä¸€è¯»ReactElementæºç -è®¤è¯†ä¸€ä¸‹è™šæ‹ŸDOM" class="heading-link"><i class="fas fa-link"></i></a>è¯»ä¸€è¯»ReactElementæºç ,è®¤è¯†ä¸€ä¸‹è™šæ‹ŸDOM</h2>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é€šè¿‡React.createElementä¸­è°ƒç”¨ReactElementæ–¹æ³•æˆ‘ä»¬èƒ½å¾—çŸ¥ReactElementçš„å…¥å‚æœ‰å“ªäº›</span></span><br><span class="line"><span class="keyword">const</span> ReactElement = <span class="function"><span class="keyword">function</span>(<span class="params">type, key, ref, self, source, owner, props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> element = &#123;</span><br><span class="line">    <span class="comment">// REACT_ELEMENT_TYPEæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œç”¨æ¥æ ‡è¯†è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªReactElement</span></span><br><span class="line">    $$<span class="keyword">typeof</span>: REACT_ELEMENT_TYPE,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†…ç½®å±æ€§èµ‹å€¼</span></span><br><span class="line">    type: type,</span><br><span class="line">    key: key,</span><br><span class="line">    ref: ref,</span><br><span class="line">    props: props,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•åˆ›é€ è¯¥å…ƒç´ çš„ç»„ä»¶</span></span><br><span class="line">    _owner: owner,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// </span></span><br><span class="line">  <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ˜¯ä¸€äº›é’ˆå¯¹ __DEV__ ç¯å¢ƒä¸‹çš„å¤„ç†ï¼Œä¸å½±å“ç†è§£ä¸»è¦é€»è¾‘</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> element;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></div></figure>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒReactElementçš„é€»è¾‘ä¹Ÿè¾ƒä¸ºç®€å•ï¼Œå®ƒåªæ˜¯æŒ‰ä¸€å®šè§„èŒƒç»„è£…äº†ä¸€ä¸ªelementå¯¹è±¡ï¼Œé€šè¿‡React.createElementæœ€ç»ˆè¿”å›åˆ°äº†å¼€å‘è€…ã€‚æˆ‘ä»¬å¹³å¸¸å»æ‰“å°ä¸€ä¸ªReactå…ƒç´ ï¼Œå°±ä¼šå‘ç°å®ƒæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ReactElementå¯¹è±¡å®ä¾‹ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚<br><img src='/images/ReactElementå…ƒç´ .png'></p>
<p>è¿™ä¸ª ReactElement å¯¹è±¡å®ä¾‹ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»¥ JavaScript å¯¹è±¡å½¢å¼å­˜åœ¨çš„å¯¹ DOM çš„æè¿°ï¼Œä¹Ÿå°±æ˜¯å¤§å®¶å¸¸è¯´çš„è™šæ‹ŸDomã€‚æ—¢ç„¶æ˜¯è™šæ‹Ÿçš„ï¼Œé‚£å®ƒç¦»é¡µé¢çš„çœŸå®DOMè¿˜æœ‰ä¸€å®šè·ç¦»ï¼Œæœ€ç»ˆæ˜¯ç”±ReactDom.renderæ–¹æ³•æ¥å¡«è¡¥çš„ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œéœ€è¦æ¸²æŸ“çš„å…ƒç´ elementï¼Œå…ƒç´ æŒ‚è½½çš„ç›®æ ‡å®¹å™¨containerä¹Ÿå°±æ˜¯çœŸå®çš„DOMèŠ‚ç‚¹ï¼Œä»¥åŠå¯é€‰å‚æ•°å›è°ƒå‡½æ•°ã€‚</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/02/27/%E6%88%91%E7%9C%9F%E7%9A%84%E6%87%82this%E5%90%97/">æˆ‘çœŸçš„æ‡‚thiså—</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-02-27</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>ä¸Šç¯‡åšå®¢æœ‰ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨å‡½æ•°é‡Œä½¿ç”¨çš„å˜é‡nameæ˜¯å±äºå…¨å±€ä½œç”¨åŸŸä¸‹çš„ï¼Œå› ä¸ºJavaScriptçš„ä½œç”¨åŸŸæ˜¯ç”±è¯æ³•ä½œç”¨åŸŸå†³å®šçš„ï¼Œå®ƒåœ¨ä»£ç é˜¶æ®µå°±å†³å®šå¥½äº†ï¼Œè·Ÿå‡½æ•°æ˜¯æ€ä¹ˆè°ƒç”¨çš„æ²¡æœ‰å…³ç³»ã€‚ä½†æ˜¯åœ¨é¢å‘å¯¹è±¡çš„è¯­è¨€ä¸­ï¼Œåœ¨å¯¹è±¡å†…éƒ¨çš„æ–¹æ³•ä¸­ä½¿ç”¨å¯¹è±¡å†…éƒ¨çš„å±æ€§æ˜¯ä¸€ä¸ªéå¸¸æ™®éçš„éœ€æ±‚ï¼ŒJavaScriptçš„ä½œç”¨åŸŸæœºåˆ¶å´å¯¹æ­¤å¹¶ä¸æ”¯æŒï¼Œå› æ­¤æˆ‘ä»¬è¿™æ—¶å€™éœ€è¦thisæœºåˆ¶ã€‚<br>æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­åŒ…å«äº†å˜é‡ç¯å¢ƒã€è¯æ³•ç¯å¢ƒã€å¤–éƒ¨ç¯å¢ƒï¼Œè¿˜æœ‰å°±æ˜¯thisã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¸­éƒ½æœ‰ä¸€ä¸ªthisã€‚æˆ‘ä»¬ä¸»è¦æ¥äº†è§£å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thiså’Œå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisã€‚<br>å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶å°æ‰“å°ä¸€ä¸‹ï¼Œæœ€ç»ˆè¾“å‡ºçš„æ˜¯windowå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisæ˜¯æŒ‡å‘windowå¯¹è±¡çš„ã€‚<br>å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨æ‰“å°thisï¼Œæ‰§è¡Œå‡½æ•°æ‰“å°çš„ä¹Ÿæ˜¯windowå¯¹è±¡ã€‚è¿™å¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ç§ç¼ºé™·ï¼Œå› ä¸ºåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisæŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œå®ƒæ‰“ç ´äº†æ•°æ®çš„è¾¹ç•Œã€‚æˆ‘ä»¬å¯ä»¥è®¾è®¡JavaScriptä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œè¿™æ—¶å€™thisçš„æŒ‡å‘ä¸ºæ€’defineã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥è®¾ç½®æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisã€‚</p>

        <h6 id="1ã€é€šè¿‡å‡½æ•°çš„callæ–¹æ³•è®¾ç½®"   >
          <a href="#1ã€é€šè¿‡å‡½æ•°çš„callæ–¹æ³•è®¾ç½®" class="heading-link"><i class="fas fa-link"></i></a>1ã€é€šè¿‡å‡½æ•°çš„callæ–¹æ³•è®¾ç½®</h6>
      <p>funA.call(objB),funAå‡½æ•°å†…éƒ¨çš„thisæŒ‡å‘äº†objBå¯¹è±¡,bindã€applyä¹Ÿå¯ä»¥ç”¨æ¥æ”¹å˜thisæŒ‡å‘ï¼Œcallå’Œapplyçš„ä½œç”¨ä¸€æ ·ï¼Œåªæ˜¯ä¼ å‚æ–¹å¼ä¸åŒã€‚callå’Œapplyéƒ½ä¼šæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ï¼Œè€Œbindæ–¹æ³•ä¸ä¼šã€‚</p>

        <h5 id="2ã€é€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•æ¥è®¾ç½®"   >
          <a href="#2ã€é€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•æ¥è®¾ç½®" class="heading-link"><i class="fas fa-link"></i></a>2ã€é€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•æ¥è®¾ç½®</h5>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> objA = &#123;</span><br><span class="line">  name: <span class="string">'able'</span>,</span><br><span class="line">  printName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">objA.printName();</span><br></pre></td></tr></table></div></figure>
<p>å½“ä½¿ç”¨å¯¹è±¡æ¥è°ƒç”¨èµ·å†…éƒ¨çš„ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•çš„thisæ˜¯æŒ‡å‘å¯¹è±¡æœ¬èº«çš„ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºåœ¨æ‰§è¡Œæ—¶å°†å…¶è½¬åŒ–æˆäº†objA.printName.call(objA);<br>è¦æ³¨æ„çš„æ˜¯ï¼Œéšå¼ç»‘å®šæœ‰ä¸€ä¸ªå¤§å‘ï¼Œå®ƒå®¹æ˜“ä¸¢å¤±ï¼å¦‚æœæˆ‘ä»¬æŠŠobjA.printNameèµ‹ç»™ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œç„¶ååœ¨å…¨å±€ç¯å¢ƒä¸­è°ƒç”¨è¿™ä¸ªå¯¹è±¡ï¼Œå®ƒå†…éƒ¨çš„thisæ˜¯æŒ‡å‘å…¨å±€å˜é‡windowçš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªå°è¯€çªæ¥è®°ä½ï¼Œéšå¼è°ƒç”¨çš„æ ¼å¼ä¸€èˆ¬æ˜¯XXX.fn();fn()å‰è¾¹å¦‚æœä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£å®ƒä¸æ˜¯éšå¼ç»‘å®šã€‚</p>

        <h5 id="3ã€é€šè¿‡æ„é€ å‡½æ•°ä¸­è®¾ç½®"   >
          <a href="#3ã€é€šè¿‡æ„é€ å‡½æ•°ä¸­è®¾ç½®" class="heading-link"><i class="fas fa-link"></i></a>3ã€é€šè¿‡æ„é€ å‡½æ•°ä¸­è®¾ç½®</h5>
      <p>åœ¨JavaScriptä¸­ï¼Œæ„é€ å‡½å¯¹è±¡æ•°åªæ˜¯ä½¿ç”¨newæ—¶è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå®ƒè·ŸC++ä¸ä¸€æ ·ï¼Œæ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œå› æ­¤ä»»ä½•ä¸€ä¸ªå‡½æ•°éƒ½å¯ä»¥ç”¨newæ¥è°ƒç”¨ï¼Œå®ƒä¸å±äºæŸä¸ªç±»ï¼Œä¹Ÿä¸ä¼šå®ä¾‹åŒ–å‡ºä¸€ä¸ªç±»ï¼Œåªèƒ½ç§°ä½œæ˜¯å¯¹äºå‡½æ•°çš„æ„é€ è°ƒç”¨ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createA</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> objA = <span class="keyword">new</span> createA (<span class="string">'able'</span>);</span><br></pre></td></tr></table></div></figure>
<p>å½“æ‰§è¡Œnew createA()æˆ‘ä»¬å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡objAï¼Œè°ƒç”¨createA.callæ–¹æ³•ï¼Œå°†objAä½œä¸ºå‚æ•°ï¼ŒcreateAçš„æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºæ—¶ï¼Œå®ƒçš„thisæŒ‡å‘æ¥objAå¯¹è±¡ã€‚ç„¶åæ‰§è¡ŒcreateAå‡½æ•°ï¼Œæ­¤æ—¶createAå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„thisæŒ‡å‘objAå¯¹è±¡ï¼Œæœ€åè¿”å›objAå¯¹è±¡ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> objA  = &#123; &#125;;</span><br><span class="line">createA.call(objA);</span><br><span class="line"><span class="keyword">return</span> objA;</span><br></pre></td></tr></table></div></figure>
<p>è¿™æ ·æˆ‘ä»¬ç”¨newæ„å»ºæ¥ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå°±ä¼šå°†æ–°å¯¹è±¡ç»‘å®šåˆ°è¿™ä¸ªå‡½æ•°çš„thisä¸Šã€‚</p>

        <h2 id="ç»‘å®šä¼˜å…ˆçº§"   >
          <a href="#ç»‘å®šä¼˜å…ˆçº§" class="heading-link"><i class="fas fa-link"></i></a>ç»‘å®šä¼˜å…ˆçº§</h2>
      <p>ä¸Šè¾¹æœ‰åˆ—åˆ°å¥½å‡ ç§ç»‘å®šè§„åˆ™ï¼Œnewç»‘å®šï¼Œé€šè¿‡callã€applyã€bindæ–¹å¼çš„æ˜¾å¼ç»‘å®šï¼Œåœ¨æŸä¸ªå¯¹è±¡ä¸Šè§¦å‘å‡½æ•°è°ƒç”¨çš„éšå¼ç»‘å®šï¼Œè¿˜æœ‰é»˜è®¤ç»‘å®šã€‚å®ƒä»¬çš„ä¼˜å…ˆçº§ä¸º:<br>newç»‘å®š &gt; æ˜¾å¼ç»‘å®š &gt; éšå¼ç»‘å®š &gt; é»˜è®¤ç»‘å®š</p>

        <h2 id="thisçš„ä¸€äº›å‘"   >
          <a href="#thisçš„ä¸€äº›å‘" class="heading-link"><i class="fas fa-link"></i></a>thisçš„ä¸€äº›å‘</h2>
      <p>åµŒå¥—å‡½æ•°çš„thisä¸ä¼šä»å¤–å±‚å‡½æ•°ç»§æ‰¿ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> objA = &#123;</span><br><span class="line">  name: <span class="string">'able'</span>,</span><br><span class="line">  printThis: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">innerB</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  innerB();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">objA.printThis();</span><br></pre></td></tr></table></div></figure>
<p>è¿™ä¸ªå†…éƒ¨å‡½æ•°innerBä¸­çš„thisï¼Œå¾ˆå®¹æ˜“è¢«ç†è§£ä¸ºå’Œå…¶å¤–å±‚printThiså‡½æ•°çš„thisæ˜¯ä¸€è‡´çš„ã€‚ä½†æ‰§è¡Œåæˆ‘ä»¬ä¼šå‘ç°ï¼ŒinnerBä¸­çš„thisæŒ‡å‘çš„æ˜¯å…¨å±€windowå¯¹è±¡ï¼Œè®©äººè¿·æƒ‘ã€‚<br>æ—©æœŸå¤§å®¶å¯èƒ½ä¼šåœ¨å¼€å‘çš„æ—¶å€™åœ¨printThiså‡½æ•°ä¸­å£°æ˜ä¸€ä¸ª_thisæ¥ä¿å­˜thisï¼Œç„¶ååœ¨innerBå‡½æ•°ä¸­ä½¿ç”¨_thisã€‚å½“æœ‰äº†ç®­å¤´å‡½æ•°ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç®­å¤´å‡½æ•°çš„ç‰¹æ€§æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å› ä¸ºç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºå…¶è‡ªèº«çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå®ƒçš„thiså–å†³äºå®ƒçš„å¤–éƒ¨å‡½æ•°ã€‚å…³äºç®­å¤´å‡½æ•°è¿˜æœ‰å‡ ç‚¹æˆ‘ä»¬éœ€è¦æ³¨æ„çš„ï¼Œå®ƒä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¸å¯ä»¥ä½¿ç”¨argumentså¯¹è±¡ï¼Œæ²¡æœ‰è‡ªå·±çš„thiså› æ­¤ä¸èƒ½ç”¨call()ç­‰æ–¹æ³•æ”¹å˜thisæŒ‡å‘ã€‚</p>

        <h2 id="æ€»ç»“"   >
          <a href="#æ€»ç»“" class="heading-link"><i class="fas fa-link"></i></a>æ€»ç»“</h2>
      <p>åˆ¤æ–­thisæŒ‡å‘æµç¨‹èµ°ä¸€éï¼šé¦–å…ˆæˆ‘ä»¬çœ‹å‡½æ•°æ˜¯å¦åœ¨newä¸­è°ƒç”¨ï¼›ç„¶åæ˜¯çœ‹å‡½æ•°æ˜¯å¦é€šè¿‡call,applyè°ƒç”¨ï¼Œæˆ–è€…ä½¿ç”¨äº†bind(å³ç¡¬ç»‘å®š);ã€æ¥ä¸‹æ¥çœ‹å‡½æ•°æ˜¯å¦åœ¨æŸä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­è°ƒç”¨(éšå¼ç»‘å®š)ï¼›å¦‚æœä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤ç»‘å®šã€‚å¦‚æœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™ç»‘å®šåˆ°undefinedï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚è¦æ³¨æ„çš„æ˜¯å¦‚æœæŠŠnullæˆ–è€…undefinedä½œä¸ºthisçš„ç»‘å®šå¯¹è±¡ä¼ å…¥callã€applyæˆ–è€…bindï¼Œè¿™äº›å€¼åœ¨è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå®é™…åº”ç”¨çš„æ˜¯é»˜è®¤ç»‘å®šè§„åˆ™ã€‚è¿˜æœ‰å¦‚æœæ˜¯ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„thisç»§æ‰¿çš„æ˜¯å¤–å±‚ä»£ç å—çš„thisã€‚</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2021/01/23/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E5%92%8C%E9%97%AD%E5%8C%85/">ä½œç”¨åŸŸé“¾å’Œé—­åŒ…</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-01-23</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>ä¸Šä¸ªåšå®¢äº†è§£äº†å¦‚ä½•é€šè¿‡è¯æ³•ç¯å¢ƒå’Œå˜é‡ç¯å¢ƒæ¥æŸ¥æ‰¾å˜é‡ï¼Œè¿™å…¶ä¸­å°±æ¶‰åŠåˆ°ä½œç”¨åŸŸé“¾äº†ï¼ŒæŠ½è±¡çš„æ¦‚å¿µä¸å¦‚æ¥æ®µä»£ç ï¼Œæ¥ï¼Œä¸Šæ¿æ —ğŸŒ°ã€‚</p>

        <h2 id="ä½œç”¨åŸŸé“¾"   >
          <a href="#ä½œç”¨åŸŸé“¾" class="heading-link"><i class="fas fa-link"></i></a>ä½œç”¨åŸŸé“¾</h2>
      <figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'zunxingdaming'</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'able'</span>;</span><br><span class="line">  printName();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'moriatry'</span>;</span><br><span class="line">main();</span><br></pre></td></tr></table></div></figure>
<p>é‚£ä¹ˆmainå‡½æ•°æ‰§è¡Œçš„ç»“æœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå½“æ‰§è¡Œåˆ°printNameå‡½æ•°å†…éƒ¨æ—¶ï¼Œnameçš„å€¼åˆ°åº•åˆ°åº•æ˜¯ä»å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡è¿˜æ˜¯mainå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å–å‘¢ï¼Ÿå¯èƒ½å®¹æ˜“æŒ‰ç…§è°ƒç”¨æ ˆçš„é¡ºåºæ¥æŸ¥æ‰¾å˜é‡ï¼Œæ‰§è¡Œåˆ°printNameå‡½æ•°å†…éƒ¨æ—¶ï¼Œä»æ ˆé¡¶åˆ°åº•ä¾æ¬¡ä¸ºprintNameå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ã€mainå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ã€å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¦‚æœæ˜¯è¿™æ ·è¾“å‡ºç»“æœåº”è¯¥æ˜¯ableï¼Œä½†å®é™…ä¸Šä¸æ˜¯è¿™æ ·ï¼Œè¿™æ˜¯ä¸ºç”šå‘¢ï¼Œè®©æˆ‘ä»¬è¿›å…¥ä½œç”¨åŸŸé“¾çš„ä¸–ç•Œæ¢ç©¶æ¢ç©¶ã€‚<br>åœ¨æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡ç¯å¢ƒé‡Œéƒ½æœ‰ä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ï¼ŒæŒ‡å‘å¤–éƒ¨çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¯ç§°å…¶ä¸ºouterã€‚ä¸€æ®µä»£ç ä¸­ä½¿ç”¨ä¸€ä¸ªå˜é‡æ—¶ï¼Œjså¼•æ“ä¼šå…ˆåœ¨å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾è¯¥å˜é‡ï¼Œç„¶åä¼šç»§ç»­åœ¨outeræŒ‡å‘çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾ã€‚printNameå‡½æ•°å’Œmainå‡½æ•°çš„outeréƒ½æ˜¯æŒ‡å‘å…¨å±€ä¸Šä¸‹æ–‡ï¼Œé‚£ä¹ˆä¸Šé¢çš„æ —å­åœ¨printNameå‡½æ•°ä¸­è¦è¾“å‡ºnameå˜é‡ï¼Œåˆ™ä¼šå–outeræŒ‡å‘çš„å…¨å±€ä½œç”¨åŸŸä¸­å¯»æ‰¾ï¼Œè¿™ç§æŸ¥æ‰¾æ–¹å¼å³ä¸ºé“¾ã€‚<br>å¯èƒ½çœ‹åˆ°è¿™é‡Œè¿˜ä¼šæœ‰ä¸€äº›ç–‘é—®ï¼ŒprintNameå‡½æ•°æ˜¯mainå‡½æ•°è°ƒç”¨çš„ï¼Œä¸ºå•¥å…¶outerä¸æ˜¯æŒ‡å‘mainå‡½æ•°å‘¢ã€‚è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªæ¦‚å¿µè¯æ³•ä½œç”¨åŸŸï¼Œåœ¨jsçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä½œç”¨åŸŸé“¾æ˜¯ç”±è¯æ³•ä½œç”¨åŸŸæ¥å†³å®šçš„ã€‚è¯æ³•ä½œç”¨åŸŸå‘¢è¡¨ç¤ºä½œç”¨åŸŸæ˜¯ç”±ä»£ç ä¸­å‡½æ•°å£°æ˜çš„ä½ç½®æ¥å†³å®šçš„ï¼Œæ‰€ä»¥è¯´å®ƒæ˜¯é™æ€çš„ï¼Œæ˜¯åœ¨ä»£ç é˜¶æ®µå°±å®šä¸‹æ¥äº†ï¼Œè·Ÿå‡½æ•°æ˜¯æ€ä¹ˆäº’ç›¸è°ƒç”¨çš„æ²¡æœ‰å…³ç³»ã€‚</p>

        <h2 id="é—­åŒ…"   >
          <a href="#é—­åŒ…" class="heading-link"><i class="fas fa-link"></i></a>é—­åŒ…</h2>
      <p>ä¸ºäº†æ›´å¥½çš„ç†è§£é—­åŒ…ï¼Œå†ä¸¾ä¸ªæ¿æ —ğŸŒ°ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> name = <span class="string">'able'</span>;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">let</span> b = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">var</span> innerFun = &#123;</span><br><span class="line">      getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> name;</span><br><span class="line">&#125;,</span><br><span class="line">setName: <span class="function"><span class="keyword">function</span>(<span class="params">newName</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a);</span><br><span class="line">  name = newName;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> innerFun;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> funA = foo();</span><br><span class="line">funA.setName(<span class="string">'moriaty'</span>);</span><br><span class="line">funA.getName();</span><br><span class="line"><span class="built_in">console</span>.log(funA.getName());</span><br></pre></td></tr></table></div></figure>
<p>innerFunæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œè¾¹åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ç”¨åˆ°äº†aå˜é‡å’Œnameå˜é‡ã€‚æ ¹æ®è¯æ³•ä½œç”¨åŸŸï¼Œå†…éƒ¨çš„å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°fooä¸­çš„å˜é‡ã€‚æ‰€ä»¥å½“innerFunè¿”å›ç»™å…¨å±€å˜é‡funAæ—¶ï¼Œå®ƒçš„ä¸¤ä¸ªæ–¹æ³•ä»å¯ä»¥ä½¿ç”¨fooå‡½æ•°ä¸­çš„å˜é‡ã€‚<br>fooå‡½æ•°æ‰§è¡Œå®Œåï¼Œå…¶æ‰§è¡Œä¸Šä¸‹æ–‡ä»æ ˆé¡¶å¼¹å‡ºï¼Œä½†æ˜¯å…¶è¿”å›çš„ä¸¤ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨äº†å˜é‡nameå’Œaï¼Œå› æ­¤è¿™ä¸¤ä¸ªå˜é‡ä»ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆsetNameå’ŒgetNameä¸¤ä¸ªæ–¹æ³•çš„èƒŒåŒ…ï¼Œæ— æ³•åœ¨å“ªé‡Œè°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬éƒ½ä¼šèƒŒç€è¿™ä¸ªfooå‡½æ•°çš„èƒŒåŒ…ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªèƒŒåŒ…ç§°ä¸ºfooå‡½æ•°çš„é—­åŒ…ã€‚<br>æ­¤æ—¶æ­¤åˆ»ï¼Œä¸Šä¸€ä¸ªæ¯”è¾ƒè§„èŒƒçš„é—­åŒ…å®šä¹‰å§ã€‚åœ¨jsä¸­ï¼Œæ ¹æ®è¯æ³•ä½œç”¨åŸŸçš„è§„åˆ™ï¼Œå†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°ä¸­å£°æ˜çš„å˜é‡ï¼Œå½“é€šè¿‡è°ƒç”¨ä¸€ä¸ªå¤–éƒ¨å‡½æ•°è¿”å›ä¸€ä¸ªå†…éƒ¨å‡½æ•°åï¼Œå³ä½¿è¯¥å¤–éƒ¨å‡½æ•°å·²ç»æ‰§è¡Œç»“æŸï¼Œä½†å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°ä½†å˜é‡ä¾ç„¶ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæˆ‘ä»¬ç§°è¿™äº›å˜é‡çš„é›†åˆç§°ä¹‹ä¸ºå¤–éƒ¨å‡½æ•°çš„é—­åŒ…ã€‚<br>é‚£ä¹ˆå½“æ‰§è¡Œåˆ°funA.setNameæ–¹æ³•ä¸­çš„name = â€˜moriatyâ€™æ—¶ï¼Œjså¼•æ“ä¼šæ²¿ç€â€œå½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡-&gt;fooå‡½æ•°é—­åŒ…-&gt;å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡â€çš„é¡ºåºæ¥æŸ¥æ‰¾nameå˜é‡ï¼Œå¯ä»¥çœ‹ä¸‹æ­¤æ—¶çš„è°ƒç”¨æ ˆå¦‚ä¸‹å›¾ã€‚æ‰€ä»¥è°ƒç”¨setNameæ—¶ï¼Œä¼šä¿®æ”¹é—­åŒ…ä¸­nameçš„å€¼ã€‚<br><img src='/images/æ‰§è¡ŒfunAæ—¶è°ƒç”¨æ ˆ.png' width='300px' height='500px'><br>å…³äºé—­åŒ…çš„é”€æ¯ï¼Œå¦‚æœå¼•ç”¨é—­åŒ…çš„å‡½æ•°æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé‚£é—­åŒ…ä¼šä¸€ç›´å­˜åœ¨åˆ°é¡µé¢å…³é—­ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªé—­åŒ…ä¹‹åä¸å®ç”¨çš„è¯ï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚å¦‚æœå¼•ç”¨é—­åŒ…çš„å‡½æ•°æ˜¯ä¸ªå±€éƒ¨å˜é‡ï¼Œç­‰å‡½æ•°é”€æ¯åï¼Œä¸‹æ¬¡jså¼•æ“æ‰§è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œåˆ¤æ–­é—­åŒ…ä¸å†è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆå†…å­˜ä¼šè¢«å›æ”¶ã€‚</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/12/26/%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87%E5%92%8C%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F/">å˜é‡æå‡å’Œå—çº§ä½œç”¨åŸŸ</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-12-26</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>å¼€å§‹æ¥è§¦JSçš„æ—¶å€™ï¼Œæƒ³å¿…å¤§å®¶éƒ½å¬è¿‡â€œå˜é‡æå‡â€è¿™ä¸ªè¯ã€‚ç”±äºå®ƒçš„å­˜åœ¨ï¼Œä¸€äº›ä»£ç çš„æ‰§è¡Œç»“æœå¯èƒ½ä¼šå‡ºä¹æˆ‘ä»¬çš„æ„æ–™ï¼Œå…¶å®ï¼Œè¿™å¯ä»¥ç®—æ˜¯JSçš„ä¸€ä¸ªè®¾è®¡ç¼ºé™·å§ã€‚ES6å¼•å…¥äº†å—çº§ä½œç”¨åŸŸå’Œletã€constå…³é”®å­—çš„æ¦‚å¿µï¼Œé€šè¿‡å®ƒä»¬èƒ½å¤Ÿè¾ƒå¥½çš„è§„é¿å˜é‡æå‡ã€‚ä½†æ˜¯ä½œä¸ºä¸€é—¨è¯­è¨€æ¥è¯´ï¼Œå‘ä¸‹å…¼å®¹æ˜¯å¿…è¦çš„ï¼Œæ‰€ä»¥å˜é‡æå‡çš„æœºåˆ¶æˆ‘ä»¬è¿˜æ˜¯æœ‰å¿…è¦å»ç†è§£ã€‚ä»Šå¤©æˆ‘ä»¬å°½é‡å»æ·±å…¥åº•å±‚æ¥åˆ†æå˜é‡æå‡çš„å­˜åœ¨åŸå› ï¼Œä»¥åŠES6åˆæ˜¯å¦‚ä½•å»å¡«è¡¥è¿™å—ç¼ºé™·çš„ã€‚<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œå¯¹äºå®ƒçš„å®šä¹‰ä¸åŒçš„å‚è€ƒèµ„æ–™éƒ½å„æœ‰å„çš„è¯´æ³•ã€‚ä¸€ä¸ªæˆ‘è®¤ä¸ºæ¯”è¾ƒå¥½ç†è§£çš„æ˜¯ï¼šä½œç”¨åŸŸæ˜¯æŒ‡åœ¨ç¨‹åºä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸï¼Œè¯¥ä½ç½®å†³å®šäº†å˜é‡çš„ç”Ÿå‘½å‘¨æœŸã€‚å®ƒæ˜¯å˜é‡å’Œå‡½æ•°çš„å¯è®¿é—®èŒƒå›´ï¼Œæ§åˆ¶ç€å˜é‡å’Œå‡½æ•°çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚<br>é‚£ä¹ˆåœ¨ES6ä¹‹å‰æˆ‘ä»¬çŸ¥é“ï¼Œåªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸã€‚å…¨å±€ä½œç”¨åŸŸé¡¾åæ€ä¹‰å°±æ˜¯åœ¨ä»£ç çš„ä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®åˆ°é‡Œè¾¹çš„å¯¹è±¡ï¼Œè€Œå‡½æ•°ä½œç”¨åŸŸå‘¢ï¼Œå°±æ˜¯æŒ‡å˜é‡æˆ–è€…å‡½æ•°æ˜¯åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„ï¼Œå®ƒåªèƒ½åœ¨å‡½æ•°å†…éƒ¨è¢«è®¿é—®ã€‚å‡½æ•°æ‰§è¡Œå®Œåå†…éƒ¨å®šä¹‰çš„å˜é‡ä¼šè¢«é”€æ¯ã€‚<br>æˆ‘ä»¬æ—©æœŸå­¦è¿‡çš„Cè¯­è¨€ã€Cä½³ä½³ã€Javaç­‰éƒ½æ˜¯æœ‰å—çº§ä½œç”¨åŸŸè¿™ä¹ˆä¸€ä¸ªæ¦‚å¿µçš„ï¼Œå®ƒæ˜¯ä¸€å¯¹å¤§æ‹¬å·åŒ…è£¹çš„ä¸€æ®µä»£ç ï¼Œæ¯”å¦‚å‡½æ•°ã€ifè¯­å¥ã€forå¾ªç¯è¯­å¥ç­‰ã€‚ç»™ä¸€äº›ç®€å•ç­‰ä»£ç å§ï¼ˆå…¨å®‡å®™è¯­è¨€é€šç”¨ï¼‰</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="number">1</span>) &#123; &#125;;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123; &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">9</span>; i++; i&lt; <span class="number">10</span>) &#123; &#125;;</span><br></pre></td></tr></table></div></figure>
<p>ä»£ç å—å†…å®šä¹‰çš„å˜é‡åœ¨ä»£ç å—å¤–éƒ¨æ˜¯æ— æ³•è¢«è®¿é—®åˆ°çš„ï¼Œè€Œä¸”ä¸Šé¢æœ‰æåˆ°ï¼Œä»£ç å—ä¸­çš„ä»£ç æ‰§è¡Œå®Œæ¯•åå…¶å®šä¹‰çš„å˜é‡ä¼šè¢«é”€æ¯ã€‚è®©æˆ‘ä»¬æ¢¦å›å¤§ä¸€ï¼Œçœ‹ä¸€æ®µCè¯­è¨€çš„ä»£ç ã€‚</p>
<figure class="highlight c"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span>* name = <span class="string">"able"</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s \n"</span>, name);</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">char</span>* name = <span class="string">"moriarty"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  printName();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>ç”±äºCè¯­è¨€æœ‰å—çº§ä½œç”¨åŸŸï¼Œobviouslyä¸Šè¾¹çš„ä»£ç æ‰“å°ç»“æœä¸ºå…¨å±€å˜é‡çš„å€¼ableã€‚ä½†æ˜¯å¦‚æœè¿™æ®µä»£ç æ˜¯ç”¨JSå†™çš„å‘¢ï¼Œç»“æœè¿˜ä¼šæ˜¯ä¸€æ ·ä¹ˆï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚<br>åœ¨ES6ä¹‹å‰ï¼ŒJavascriptæ˜¯ä¸æ”¯æŒå—çº§ä½œç”¨åŸŸçš„ã€‚å¯èƒ½è¿™é—¨è¯­è¨€è®¾è®¡çš„åˆè¡·å°±æ˜¯ç®€çº¦ï¼ˆè€Œä¸ç®€å•ï¼‰ï¼Œæ²¡æœ‰è€ƒè™‘å—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥ä½œç”¨åŸŸå†…éƒ¨çš„å˜é‡éƒ½è¢«ç»Ÿä¸€æå‡äº†ã€‚å¯¼è‡´å‡½æ•°ä¸­çš„å˜é‡æ— è®ºåœ¨ä½•å¤„å£°æ˜ï¼Œç¼–è¯‘æ—¶éƒ½ä¼šè¢«è¿›å…¥åˆ°æ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡ç¯å¢ƒä¸­ï¼Œå› æ­¤åœ¨æ•´ä¸ªå‡½æ•°ä½“å†…æ‰€æœ‰åœ°æ–¹éƒ½èƒ½è¢«è®¿é—®åˆ°ã€‚<br>æˆ‘ä»¬æ¥ç”¨JSæ¥å®ç°ä¸Šé¢çš„ä»£ç ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">"able"</span>;</span><br><span class="line">printName = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(name);</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> name = <span class="string">"moriarty"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="built_in">console</span>.log(name);</span><br><span class="line">&#125;</span><br><span class="line">printName();</span><br></pre></td></tr></table></div></figure>
<p>è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆå‘¢ï¼Œæ²¡æƒ³åˆ°å§ï¼Œæ—¢ä¸æ˜¯â€ableâ€ä¹Ÿä¸æ˜¯â€moriartyâ€ï¼Œæ˜¯undefinedï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæ ¹æ®ä¹‹å‰æ–‡ç« æ‰€å­¦ï¼Œé¦–å…ˆåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡å’Œè°ƒç”¨æ ˆï¼Œå…¶ä¸­printNameå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡ç¯å¢ƒä¸­nameä¸ºundefinedã€‚æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå¥½åï¼ŒJSå¼•æ“æ‰§è¡Œå‡½æ•°å†…éƒ¨ä»£ç ã€‚å‡½æ•°æ‰§è¡Œæ—¶JSä¼šä¼˜å…ˆä»å½“å‰çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾å˜é‡ï¼Œé¦–å…ˆæ‰§è¡Œconsoleæ‰“å°ï¼Œé‚£ä¹ˆå®ƒä¼šä½¿ç”¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å€¼undefinedã€‚ç›¸ä¿¡å¾ˆå¤šäººè·Ÿä¸ºä¸€æ ·ï¼Œåˆšå¼€å§‹æ¥è§¦JSçš„æ—¶å€™ä¼šè§‰å¾—è¿™ç§ç»“æœæœ‰äº›å¥‡æ€ªå§ã€‚<br>è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯æœ¬åº”è¢«é”€æ¯çš„å˜é‡å´æ²¡æœ‰é”€æ¯ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">S</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>ä¸ºäº†è§£å†³å˜é‡æå‡ï¼ŒES6å¼•å…¥äº†letå’Œconstå…³é”®å­—ï¼Œä½¿JSä¹Ÿæ‹¥æœ‰äº†å—çº§ä½œç”¨åŸŸã€‚letå’Œconstçš„ç”¨æ³•å¤§å®¶éƒ½å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ES6æ˜¯å¦‚æœè§£å†³å˜é‡æå‡çš„å§ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> a = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(a); <span class="comment">// 2</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(a); <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line">test();</span><br></pre></td></tr></table></div></figure>
<p>å¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æœå°±å¾ˆç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸäº†ï¼Œè¿™æ˜¯å› ä¸ºletå…³é”®å­—æ”¯æŒå—çº§ä½œç”¨åŸŸï¼Œåœ¨ä½œç”¨åŸŸå†…å£°æ˜çš„å˜é‡ä¸ä¼šå½±å“å¤–é¢çš„å˜é‡ã€‚JSå¼•æ“é€šè¿‡å˜é‡ç¯å¢ƒæ¥å®ç°å‡½æ•°ä½œç”¨åŸŸï¼Œé‚£ä¹ˆå¤§å®¶è‚¯å®šä¼šæƒ³ï¼ŒES6å³æ”¯æŒå˜é‡æå‡ï¼Œåˆå¦‚ä½•åœ¨å‡½æ•°ä½œç”¨åŸŸçš„åŸºç¡€ä¸Šæ¥æ”¯æŒå—çº§ä½œç”¨åŸŸï¼Œå®ƒæ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬ç»“åˆå‰é¢çš„åšå®¢æ‰§è¡Œä¸Šä¸‹æ–‡ç›¸å…³çš„çŸ¥è¯†æ¥ä¸€èµ·åˆ†æã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setBlock</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> m = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> n = <span class="number">1</span>;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> n = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">var</span> o = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">let</span> p = <span class="number">4</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(m);</span><br><span class="line">    <span class="built_in">console</span>.log(n);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(n);</span><br><span class="line">  <span class="built_in">console</span>.log(o);</span><br><span class="line">  <span class="built_in">console</span>.log(p);</span><br><span class="line">&#125;</span><br><span class="line">setBlock();</span><br></pre></td></tr></table></div></figure>
<p>æ‰§è¡Œä¸Šé¢çš„ä»£ç æ—¶ï¼Œé¦–å…ˆç¼–è¯‘å¹¶åˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå‡½æ•°å†…éƒ¨varå£°æ˜çš„å˜é‡åœ¨ç¼–è¯‘é˜¶æ®µå­˜æ”¾åˆ°äº†å˜é‡ç¯å¢ƒä¸­ï¼Œletå£°æ˜çš„å˜é‡ï¼Œå­˜æ”¾åˆ°äº†è¯æ³•ç¯å¢ƒä¸­ï¼Œä½†æ˜¯å¦‚æœæ˜¯åœ¨å‡½æ•°çš„å—çº§ä½œç”¨åŸŸå†…éƒ¨letå£°æ˜çš„å˜é‡å¹¶æ²¡æœ‰å­˜æ”¾åˆ°è¯æ³•ç¯å¢ƒä¸­ã€‚<br><img src="/images/setBlock%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87.png" alt="setBlockå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡.png"><br>æ¥ä¸‹æ¥æ‰§è¡Œä»£ç ï¼Œæ­¤æ—¶è¯æ³•ç¯å¢ƒä¸­nçš„å€¼è¢«è®¾ç½®æˆ1ã€‚è€Œå½“è¿›å…¥å—çº§ä½œç”¨åŸŸæ—¶ï¼Œä½œç”¨åŸŸå—ä¸­é€šè¿‡letå£°æ˜å½“å˜é‡ä¼šè¢«å­˜æ”¾åœ¨è¯æ³•ç¯å¢ƒä¸€ä¸ªå•ç‹¬çš„åŒºåŸŸä¸­ï¼Œä¸ä½œç”¨åŸŸå—å¤–é¢çš„å˜é‡äº’ä¸å½±å“ï¼Œä¹Ÿäº§ç”Ÿäº†ä¸€ä¸ªå°å‹æ ˆç»“æ„ã€‚<br><img src="/images/setBlock%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C.png" alt="setBlockå‡½æ•°æ‰§è¡Œ.png"><br>æ ˆçš„åº•éƒ¨æ˜¯å‡½æ•°æœ€å¤–å±‚çš„å˜é‡ï¼Œè¿›å…¥å—çº§ä½œç”¨åŸŸåå—å†…letå’Œconstå£°æ˜çš„å˜é‡ä¼šè¿›æ ˆï¼Œä½œç”¨åŸŸæ‰§è¡Œå®Œåè¯¥ä½œç”¨åŸŸçš„ä¿¡æ¯ä»é¡¶éƒ¨å¼¹å‡ºã€‚è€Œconsole.log(m)æ—¶éœ€è¦åœ¨è¯æ³•ç¯å¢ƒå’Œå˜é‡ç¯å¢ƒä¸­æ¥æ‰¾å˜é‡açš„å€¼äº†ã€‚é¦–å…ˆåœ¨è¯æ³•ç¯å¢ƒçš„æ ˆä¸­ä»é¡¶éƒ¨å‘åº•éƒ¨æŸ¥æ‰¾ï¼Œå¦‚æœåœ¨æŸä¸ªä½œç”¨åŸŸå—ä¸­æ‰¾åˆ°äº†åˆ™ç›´æ¥è¿”å›ï¼Œæ²¡æœ‰æ‰¾åˆ°åˆ™ç»§ç»­åœ¨å˜é‡ç¯å¢ƒä¸­æŸ¥æ‰¾ã€‚<br><img src="/images/%E5%8F%98%E9%87%8F%E6%9F%A5%E6%89%BE%E8%BF%87%E7%A8%8B.png" alt="å˜é‡æŸ¥æ‰¾è¿‡ç¨‹.png"><br>é€šè¿‡ä»¥ä¸Šæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œå—çº§ä½œç”¨åŸŸæ˜¯é€šè¿‡è¯æ³•ç¯å¢ƒçš„å°å‹æ ˆç»“æ„æ¥å®ç°çš„ï¼Œè€ŒJSå˜é‡æå‡çš„ç‰¹æ€§æ˜¯é€šè¿‡å˜é‡ç¯å¢ƒæ¥å®ç°çš„ã€‚æƒ³å¿…é€šè¿‡ä»Šå¤©çš„åˆ†æï¼Œå¤§å®¶å¯¹å˜é‡æå‡å’Œå—çº§ä½œç”¨åŸŸæœ‰äº†æ¯”è¾ƒæ¸…æ™°çš„äº†è§£å•¦ã€‚</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/11/14/JavaScript%E8%B0%83%E7%94%A8%E6%A0%88/">JavaScriptè°ƒç”¨æ ˆ</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-11-14</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œç›¸ä¿¡å¤§å®¶åº”è¯¥ä¼šé‡åˆ°è¿‡ä¸‹è¾¹è¿™ç§æŠ¥é”™ã€‚ä»å­—é¢æ„æ€æˆ‘ä»¬èƒ½ç†è§£ä¸ºå‡ºç°äº†æ ˆæº¢å‡ºï¼Œæ ˆå ç”¨çš„ç©ºé—´æ¯”åˆ†é…ç»™å®ƒçš„ç©ºé—´è¿˜å¤§ï¼Œå¸¸è§çš„åŸå› æ˜¯ä¸¤ä¸ªå‡½æ•°ä¹‹é—´çš„äº’ç›¸è°ƒç”¨ï¼Œè¿˜æœ‰å°±æ˜¯æ²¡æœ‰ç»ˆæ­¢æ¡ä»¶çš„é€’å½’ã€‚æ ˆå¤§å®¶éƒ½çŸ¥é“æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œçš„æ ˆåˆæ˜¯ä»€ä¹ˆå‘¢ã€‚é‚£ä¹ˆæˆ‘ä»¬ä»Šå¤©æ¥å¥½å¥½äº†è§£ä¸€ä¸‹è°ƒç”¨æ ˆï¼Œæ¦‚æ‹¬æ¥è¯´å®ƒæ˜¯ç”¨æ¥ç®¡ç†å‡½æ•°è°ƒç”¨å…³ç³»çš„æ•°æ®ç»“æ„ã€‚<br>é¦–å…ˆæˆ‘ä»¬æ¥è¯´è¯´å‡½æ•°è°ƒç”¨ï¼Œå®ƒæ˜¯æŒ‡æˆ‘ä»¬å£°æ˜ä¸€ä¸ªå‡½æ•°å¹¶ä½¿å®ƒè¿è¡Œï¼Œå…·ä½“çš„å†™æ³•ä¹Ÿå°±æ˜¯ä¸€ä¸ªå‡½æ•°åç§°åè¾¹åŠ ä¸Šä¸€å¯¹åœ†æ‹¬å·ã€‚ä¸¾ä¸ªæ¿æ —</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">'able'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> age = <span class="number">18</span>;</span><br><span class="line"><span class="keyword">return</span> name+age;</span><br><span class="line">&#125;</span><br><span class="line">sayHello();</span><br></pre></td></tr></table></div></figure>
<p>åœ¨æ‰§è¡Œå‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬ç”¨ä¸Šä¸€æ¬¡çš„å­¦ä¹ å¯ä»¥å¾—çŸ¥ï¼Œè¿™æ®µä»£ç ä¼šç”Ÿæˆå¯¹åº”çš„å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­çš„å˜é‡ç¯å¢ƒé‡ŒåŒ…å«äº†å£°æ˜çš„å‡½æ•°sayHelloå’Œå…¨å±€å˜é‡nameã€ageã€‚æ¥ä¸‹æ¥å¼€å§‹æ‰§è¡Œå…¨å±€ä»£ç ï¼Œè¿™é‡Œçš„sayHelloä¾¿æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå…·ä½“ä¼šæœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚ç¬¬ä¸€æ­¥æ˜¯ä»å…¨å±€æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ä¸­æ‹¿åˆ°å£°æ˜çš„å‡½æ•°ä»£ç ï¼Œç„¶åæ˜¯å¯¹è¿™æ®µå‡½æ•°å¯¹ä»£ç è¿›è¡Œç¼–è¯‘ï¼Œåˆ›å»ºå‡½æ•°å¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå¯æ‰§è¡Œä»£ç ï¼Œæœ€åæ‰§è¡Œä»£ç å¹¶è¾“å‡ºç»“æœã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œåœ¨æ‰§è¡ŒJSä»£ç çš„æ—¶å€™å¯èƒ½ä¼šæœ‰å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡çš„å­˜åœ¨ï¼Œæ¯”å¦‚å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±èƒ½ç”¨æ ˆè¿™ç§æ•°æ®ç»“æ„ï¼Œæ¥ç®¡ç†è¿™äº›æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚<br>è¯´åˆ°æ ˆæˆ‘ä»¬èƒ½æƒ³åˆ°æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯åè¿›å…ˆå‡ºäº†ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå¥½ä»¥åï¼Œå®ƒä»¬ä¾¿ä¼šè¢«å‹å…¥åˆ°æ ˆä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè°ƒç”¨æ ˆï¼Œä¹Ÿå«æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆã€‚ä¸ºäº†æ›´å¥½ç†è§£å®ƒï¼Œæˆ‘ä»¬æ¥å†™ä¸€æ®µæ¯”å¼€å¤´é‚£æ®µå¤æ‚äº›çš„ä»£ç ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">6</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">by</span>(<span class="params">b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> b+c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">byTotal</span>(<span class="params">b, c</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">var</span> d = <span class="number">5</span>;</span><br><span class="line">  result = by(b, c);</span><br><span class="line">  <span class="keyword">return</span> a + result + d;</span><br><span class="line">&#125;</span><br><span class="line">byTotal(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>heä¸Šè¾¹çš„æƒ…å†µæ˜¯åœ¨ä¸€ä¸ªå‡½æ•°ä¸­è°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬æ¥è¯¦ç»†çš„åˆ†æä¸€ä¸‹è¿‡ç¨‹ã€‚<br>é¦–å…ˆåˆ›å»ºå…¨å±€ä¸Šä¸‹æ–‡å¹¶å…¥æ ˆï¼Œå½“å‰ç”Ÿæˆçš„å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡ç¯å¢ƒå¯¹è±¡ä¸­æœ‰å˜é‡aã€å‡½æ•°byå’ŒbyTotalã€‚å½“å®ƒå…¥æ ˆåï¼Œå…¨å±€ä»£ç è¢«æ‰§è¡Œï¼Œé¦–å…ˆ6è¢«èµ‹ç»™aï¼Œæ­¤æ—¶è°ƒç”¨æ ˆä¸­çš„æƒ…å†µå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src='/images/å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡.png' width='300px' height='500px'><br>ç„¶åæ˜¯è°ƒç”¨byTotalå‡½æ•°ï¼Œè°ƒç”¨æ—¶æˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹å…¶è¿›è¡Œç¼–è¯‘ï¼Œä¹Ÿæ˜¯ä¸ºå…¶åˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶ä½¿å…¶è¿›å…¥æ ˆä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src='/images/byAllå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡.png' width='300px' height='500px'><br>æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå¥½åæˆ‘ä»¬å¼€å§‹æ‰§è¡Œå‡½æ•°ã€‚é¦–å…ˆå¯¹dè¿›è¡Œèµ‹å€¼5ï¼Œç„¶åæˆ‘ä»¬ä¼šæ‰§è¡Œåˆ°byå‡½æ•°ï¼Œä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªbyå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶ä½¿å…¶å…¥è´¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src='/images/byå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡.png' width='300px' height='500px'><br>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™å¼€å§‹å‡ºæ ˆå‘¢ï¼Œä¾¿æ˜¯byå‡½æ•°çš„æ‰§è¡Œç»“æœè¿”å›åï¼Œå®ƒå¯¹åº”çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¾¿ä¼šä»æ ˆé¡¶å¼¹å‡ºå•¦ï¼Œæ­¤æ—¶byAllä¸­çš„resultå¾—åˆ°äº†è¿”å›å€¼3ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src='images/å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å‡ºæ ˆ.png' width='300px' height='500px'><br>ç„¶ååœ¨byAllæ‰§è¡Œå®Œæœ€åä¸€è¡Œå¹¶è¿”å›å€¼åï¼Œå®ƒå¯¹åº”çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¹Ÿä¼šå‡ºæ ˆï¼Œæ­¤æ—¶çš„è°ƒç”¨æ ˆä¸­é‡æ–°å›åˆ°äº†æœ€åˆçš„äºšå­ï¼Œåªå‰©ä¸‹ä¸€ä¸ªå­¤é›¶é›¶çš„å…¨å±€ä¸Šä¸‹æ–‡äº†ã€‚<br>é€šè¿‡ä¸Šè¾¹çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°è°ƒç”¨æ ˆçš„ä½œç”¨äº†ï¼Œå®ƒå¯ä»¥å¾ˆç›´è§‚çš„ç»™æˆ‘ä»¬å±•ç¤ºæŸä¸ªå‡½æ•°åœ¨è¢«æ‰§è¡Œï¼Œç‰¹åˆ«æ˜¯å‡½æ•°è°ƒç”¨è¾ƒå¤šæ—¶ï¼Œèƒ½è®©æˆ‘ä»¬å¾ˆæ¸…æ¥šå„ä¸ªå‡½æ•°ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚<br>é‚£ä¹ˆè®²å®Œäº†åŸç†ï¼Œå®ƒåœ¨å®è·µå±‚é¢ä¸Šçš„åº”ç”¨æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ã€‚åœ¨å¤§å®¶ç”¨chromeè°ƒè¯•çš„æ—¶å€™ï¼Œsourceä¸­debugçš„ä½ç½®æœ‰ä¸€ä¸ªCall Stackä¸çŸ¥é“å¤§å®¶è¿˜æœ‰æ²¡æœ‰å°è±¡å‘¢ã€‚æˆ‘ä»¬åœ¨sourceä¸­æ–°å»ºä¸€ä¸ªä»£ç å—(new snippet)ï¼ŒæŠŠä¸Šè¾¹é‚£æ®µdemoæ”¾å…¥jsæ–‡ä»¶ä¸­ï¼Œæ‰“ä¸Šæ–­ç‚¹æ¥æ‰§è¡Œä¸€ä¸‹è¿™æ®µä»£ç ã€‚<br><img src="/images/chrome%E8%B0%83%E8%AF%95%E8%B0%83%E7%94%A8%E6%A0%88.png" alt="chromeè°ƒè¯•è°ƒç”¨æ ˆ.png"><br>æˆ‘ä»¬åœ¨byå‡½æ•°ä¸­æ‰“ä¸Šæ–­ç‚¹ï¼Œå³é”®ç‚¹å‡»runï¼Œå¯ä»¥çœ‹åˆ°å›¾ä¸­çš„ä»£ç æ‰§è¡Œåˆ°æ–­ç‚¹å¤„æš‚åœäº†ï¼Œå³ä¾§æœ‰Call Stackè¿™ä¸€æ å¯ä»¥çœ‹åˆ°å½“å‰è°ƒç”¨æ ˆçš„æƒ…å†µï¼Œå°±è·Ÿæˆ‘ä¸Šå›¾ä¸­ç”»çš„ä¸€è‡´ï¼Œä»åº•éƒ¨åˆ°é¡¶éƒ¨ä¾æ¬¡æ˜¯anonymousï¼Œä¹Ÿå°±æ˜¯å…¨å±€çš„å‡½æ•°å…¥å£ï¼Œå¾€ä¸Šæ˜¯byAllå‡½æ•°ï¼Œæœ€åé¡¶éƒ¨æ˜¯byå‡½æ•°ã€‚æˆ‘ä»¬èƒ½å¾ˆç›´è§‚æ˜äº†çš„å¾—çŸ¥å‡½æ•°ä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€‚å¯èƒ½demoæ¯”è¾ƒç®€å•å•Šï¼Œä½†æ˜¯åœ¨åˆ†æè¾ƒä¸ºé•¿çš„å¤æ‚çš„ä»£ç æ—¶ï¼Œå®ƒæ˜¯æ¯”è¾ƒæœ‰æ•ˆçš„ï¼ŒåŒ…æ‹¬åœ¨å®šä½é—®é¢˜æ—¶ä¹Ÿæ˜¯ä¸€æ ·ã€‚å¦‚æœä¸ä¹ æƒ¯æ‰“æ–­ç‚¹çš„ç«¥é‹ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•â€”â€”console.trace()ï¼Œå®ƒçš„æ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°å…¶ç»“æœã€‚<br><img src="/images/console-trace.png" alt="console-trace.png"></p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/10/17/JavaScript%E4%BB%A3%E7%A0%81%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F/">JavaScriptä»£ç çš„æ‰§è¡Œé¡ºåº</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-10-17</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>ä»Šå¤©æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹Javascriptçš„æ‰§è¡Œé¡ºåºï¼Œäº†è§£å®ƒæ˜¯æ€ä¹ˆå¦‚ä½•è¿è¡Œçš„ã€‚<br>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">showName();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'name'</span>, name);</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'able'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ‰§è¡Œå‡½æ•°showName'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<p>Javascriptæ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼Œé‚£ä¹ˆçœ‹ä¸Šå»åœ¨æ‰§è¡Œåˆ°ç¬¬ä¸€è¡Œçš„æ—¶å€™å‡½æ•°showNameå¹¶æ²¡æœ‰å®šä¹‰ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸æ˜¯ä¼šæŠ¥é”™å‘¢ã€‚æƒ³å¿…å¤§å®¶åº”è¯¥éƒ½çŸ¥é“,å®ƒçš„ç»“æœå…¶å®æ˜¯æ‰§è¡Œå‡½æ•°showName;name undefined;<br>é‚£ä¹ˆé€šè¿‡ä¸Šè¾¹çš„æ‰§è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥è®¤è¯†åˆ°ï¼Œå‡½æ•°æˆ–è€…å˜é‡å¯ä»¥åœ¨å®ƒè¢«å®šä¹‰ä¹‹å‰ä½¿ç”¨ã€‚å¯¹äºå˜é‡è€Œè¨€ï¼Œå¦‚æœå®ƒåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æœªå£°æ˜ï¼Œé‚£ä¹ˆjsæ‰§è¡Œä¼šæŠ¥é”™ã€‚å¦‚æœåœ¨ä¸€ä¸ªå˜é‡å®šä¹‰ä¹‹å‰ä½¿ç”¨å®ƒï¼Œä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯è¯¥å˜é‡çš„å€¼æ˜¯undefinedã€‚å¦‚æœåœ¨ä¸€ä¸ªå‡½æ•°å®šä¹‰ä¹‹å‰æ‰§è¡Œå®ƒï¼Œä¸ä¼šæŠ¥é”™ï¼Œè€Œä¸”å‡½æ•°èƒ½æ­£å¸¸æ‰§è¡Œã€‚<br>é‚£å¯èƒ½å°±ä¼šäº§ç”Ÿä¸€äº›ç–‘é—®äº†ï¼Œä¸ºå•¥å­å˜é‡å’Œå‡½æ•°èƒ½åœ¨å®šä¹‰ä¹‹å‰ä½¿ç”¨å‘¢ï¼Œjsä¸æ˜¯æƒ³è±¡ä¸­ä¸€è¡Œä¸€è¡Œæ‰§è¡Œçš„ä¹ˆã€‚éƒ½æ˜¯æå‰ä½¿ç”¨ï¼Œä¸ºä½•å‡½æ•°èƒ½æ­£å¸¸æ‰§è¡Œï¼Œå˜é‡å€¼å´æ˜¯undefinedã€‚æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥åˆ†æã€‚<br>é¦–å…ˆæˆ‘ä»¬äº†è§£ä¸€ä¸‹jsä¸­çš„å£°æ˜å’Œèµ‹å€¼ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å˜é‡</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'able'</span>;</span><br><span class="line"><span class="comment">//è¿™æ®µä»£ç å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">var</span> name  <span class="comment">//å£°æ˜éƒ¨åˆ†</span></span><br><span class="line">name = <span class="string">'able'</span>; <span class="comment">//æ‰§è¡Œéƒ¨åˆ†</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hahhahaa'</span>);</span><br><span class="line">&#125;<span class="comment">//å®Œæ•´çš„å‡½æ•°å£°æ˜ï¼Œä¸æ¶‰åŠåˆ°èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> showName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'wowowow'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> showName  <span class="comment">//å£°æ˜éƒ¨åˆ†</span></span><br><span class="line">showName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'wowowow'</span>);</span><br><span class="line">&#125; <span class="comment">//èµ‹å€¼éƒ¨åˆ†</span></span><br></pre></td></tr></table></div></figure>
<p>äº†è§£å£°æ˜å’Œèµ‹å€¼ä¹‹åï¼Œï¼Œæˆ‘ä»¬å…ˆæ¥èŠèŠå˜é‡æå‡ã€‚<br>å˜é‡æå‡å‘¢ï¼Œå®ƒæ˜¯æŒ‡åœ¨Javascriptä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒJSå¼•æ“æŠŠå˜é‡çš„å£°æ˜éƒ¨åˆ†å’Œå‡½æ•°çš„å£°æ˜éƒ¨åˆ†æå‡åˆ°ä»£ç å¼€å¤´çš„â€˜è¡Œä¸ºâ€™ã€‚å˜é‡è¢«æå‡åï¼Œä¼šç»™å˜é‡è®¾ç½®é»˜è®¤å€¼â€˜undefinedâ€™ã€‚ä¸‹é¢æˆ‘ä»¬ç”¨ä»£ç æ¥æ¨¡æ‹Ÿä¸€ä¸‹å˜é‡æå‡ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å˜é‡æå‡éƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="literal">undefined</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'showNameè¢«è°ƒç”¨â€˜);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//å¯æ‰§è¡Œä»£ç éƒ¨åˆ†</span></span><br><span class="line"><span class="string">showName();</span></span><br><span class="line"><span class="string">console.log('</span>name<span class="string">', name);</span></span><br><span class="line"><span class="string">name = '</span>able<span class="string">';</span></span><br></pre></td></tr></table></div></figure>
<p>å¯ä»¥å‘ç°ï¼Œå®ƒçš„æ‰§è¡Œç»“æœå’Œæˆ‘ä»¬æœ€å¼€å§‹çš„ä»£ç æ˜¯ä¸€æ¯›ä¸€æ ·çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±ç†è§£äº†ä¸ºå•¥å­å¯ä»¥åœ¨å®šä¹‰ä¹‹å‰ä½¿ç”¨å‡½æ•°æˆ–è€…å˜é‡çš„åŸå› äº†â€”â€”å‡½æ•°å’Œå˜é‡åœ¨æ‰§è¡Œä¹‹å‰éƒ½æå‡åˆ°äº†ä»£ç å¼€å¤´ã€‚<br>ä»å­—é¢ä¸Šæ¥çœ‹ï¼Œå˜é‡æå‡æ„å‘³ç€å˜é‡å’Œå‡½æ•°çš„å£°æ˜ä¼šç§»åŠ¨åˆ°ä»£ç çš„å¼€å¤´ï¼Œå°±åƒæˆ‘ä»¬ä¸Šè¾¹æ¨¡æ‹Ÿçš„é‚£æ ·ï¼Œä½†äº‹å®ä¸Šï¼Œè¿™å¯èƒ½ä¸å¤ªå‡†ç¡®ï¼Œå˜é‡å’Œå‡½æ•°å£°æ˜åœ¨ä»£ç ä¸­çš„ä½ç½®æ˜¯ä¸ä¼šè¢«æ”¹å˜çš„ï¼Œè€Œæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µä¼šè¢«JSå¼•æ“æ”¾å…¥åˆ°å†…å­˜ä¸­ã€‚è¿™é‡Œåˆæ¶‰åŠåˆ°JSçš„æ‰§è¡Œæµç¨‹äº†ï¼Œä¸€æ®µJSä»£ç åœ¨æ‰§è¡Œä¹‹å‰éœ€è¦è¢«å¼•æ“ç¼–è¯‘ï¼Œç¼–è¯‘å®Œæˆåæ‰ä¼šè¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚<br>ä¸€æ®µä»£ç åœ¨ç»è¿‡ç¼–è¯‘åï¼Œä¼šç”Ÿæˆä¸¤éƒ¨åˆ†å†…å®¹ï¼šæ‰§è¡Œä¸Šä¸‹æ–‡å’Œå¯æ‰§è¡Œä»£ç ã€‚æ‰€è°“æ‰§è¡Œä¸Šä¸‹æ–‡å‘¢ï¼Œå®ƒæ˜¯æŒ‡JSæ‰§è¡Œä¸€æ®µä»£ç æ—¶çš„è¿è¡Œç¯å¢ƒã€‚æ¯”å¦‚è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå°±ä¼šè¿›å…¥è¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œç¡®å®šè¯¥å‡½æ•°åœ¨æ‰§è¡ŒæœŸé—´ç”¨åˆ°çš„thisã€å˜é‡ã€å¯¹è±¡ä»¥åŠå‡½æ•°ç­‰ã€‚åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å­˜åœ¨ä¸€ä¸ªå˜é‡ç¯å¢ƒçš„å¯¹è±¡ï¼Œå®ƒé‡Œè¾¹ä¿å­˜äº†å˜é‡æå‡çš„å†…å®¹ï¼Œæœ€å¼€å§‹æˆ‘ä»¬ç ”ç©¶çš„é‚£æ®µä»£ç ä¸­ï¼Œå˜é‡nameå’Œå‡½æ•°showNameï¼Œéƒ½ä¿å­˜åœ¨è¯¥å¯¹è±¡ä¸­ã€‚æˆ‘ä»¬ç»“åˆä»£ç æ¥åˆ†æä¸€ä¸‹å¦‚ä½•ç”Ÿæˆå˜é‡ç¯å¢ƒå¯¹è±¡ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">showName();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'name'</span>, name);</span><br><span class="line"><span class="keyword">var</span> name = <span class="string">'ableF'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'å®‰æ’nameâ€˜);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></div></figure>
<p>ç¬¬ä¸€è¡Œç¬¬äºŒè¡Œä¸æ˜¯å£°æ˜æ“ä½œï¼Œæ‰€ä»¥å¼•æ“ä¸ä¼šåšä»»ä½•å¤„ç†ã€‚ç¬¬ä¸‰è¡Œæœ‰varå£°æ˜ï¼Œå› æ­¤å¼•æ“å°†åœ¨ç¯å¢ƒå¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºnameçš„å±æ€§ï¼Œå¹¶ä½¿ç”¨undefinedå¯¹å…¶åˆå§‹åŒ–ã€‚ç¬¬å››è¡Œï¼Œå¼•æ“å‘ç°äº†ä¸€ä¸ªé€šè¿‡functionå®šä¹‰çš„å‡½æ•°ï¼Œå®ƒå°†å‡½æ•°å­˜å‚¨åˆ°å †ä¸­ï¼Œå¹¶åœ¨ç¯å¢ƒå˜é‡ä¸­åˆ›å»ºäº†ä¸€ä¸ªshowNameçš„å±æ€§ï¼Œç„¶åå°†è¯¥å±æ€§å€¼æŒ‡å‘å †ä¸­å‡½æ•°çš„ä½ç½®ï¼Œè¿™æ ·å°±ç”Ÿæˆäº†å˜é‡ç¯å¢ƒå¯¹è±¡ã€‚<br>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€å¼ å›¾æ¥å½¢è±¡æ»´å±•ç¤ºJsçš„æ‰§è¡Œæµç¨‹ã€‚<br><img src="/images/Js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6.jpg" alt="Jsæ‰§è¡Œæœºåˆ¶.jpg"><br>é‚£ä¹ˆåœ¨æœ‰äº†æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå¯æ‰§è¡Œä»£ç åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥æ‰§è¡Œé˜¶æ®µäº†ã€‚å½“æ‰§è¡ŒshowNameå‡½æ•°æ—¶ï¼ŒJSå¼•æ“ä¾¿åœ¨å˜é‡ç¯å¢ƒå¯¹è±¡ä¸­æŸ¥æ‰¾è¯¥å‡½æ•°ï¼Œç”±äºå˜é‡ç¯å¢ƒå¯¹è±¡ä¸­å­˜åœ¨è¯¥å‡½æ•°çš„å¼•ç”¨ï¼Œæ‰€ä»¥JSå¼•æ“ä¾¿å¼€å§‹æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå¹¶ä¸”è¾“å‡ºâ€˜æ‰§è¡Œå‡½æ•°showNameâ€˜çš„ç»“æœï¼›æ¥ä¸‹æ¥æ‰“å°nameä¿¡æ¯ï¼ŒJSå¼•æ“åœ¨å˜é‡ç¯å¢ƒå¯¹è±¡ä¸­æŸ¥æ‰¾è¯¥å¯¹è±¡ï¼Œç”±äºå˜é‡ç¯å¢ƒä¸­å­˜åœ¨nameå˜é‡ä¸”å€¼ä¸ºundefinedï¼Œå› æ­¤è¾“å‡ºundefinedã€‚æ¥ä¸‹æ¥æŠŠâ€˜ableâ€™èµ‹å€¼ç»™nameå˜é‡ï¼Œèµ‹å€¼åå˜é‡ç¯å¢ƒä¸­çš„nameå±æ€§å€¼æ”¹ä¸ºâ€˜ableâ€™ã€‚<br>é‚£ä¹ˆå¦‚æœåœ¨ä»£ç ä¸­å‡ºç°ç›¸åŒçš„å˜é‡æˆ–è€…å‡½æ•°ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢ä¸€æ®µä»£ç ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">geName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'able'</span>);</span><br><span class="line">&#125;</span><br><span class="line">getName();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'moriaty'</span>);</span><br><span class="line">&#125;</span><br><span class="line">getName();</span><br></pre></td></tr></table></div></figure>
<p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å®ƒçš„å®Œæ•´æ‰§è¡Œæµç¨‹ã€‚é¦–å…ˆæ˜¯ç¼–è¯‘é˜¶æ®µï¼Œé‡åˆ°äº†ç¬¬ä¸€ä¸ªgetNameå‡½æ•°ï¼Œä¼šæŠŠè¯¥å‡½æ•°æ”¾åˆ°å˜é‡ç¯å¢ƒä¸­ã€‚æ¥ä¸‹æ¥æ˜¯ç¬¬äºŒä¸ªgetNameå‡½æ•°ï¼Œç»§ç»­å­˜æ”¾åˆ°å˜é‡ç¯å¢ƒä¸­ï¼Œä½†æ˜¯å˜é‡ç¯å¢ƒä¸­å·²ç»æœ‰ä¸€ä¸ªgetNameäº†ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªä¼šå°†ç¬¬ä¸€ä¸ªè¦†ç›–ã€‚é‚£ä¹ˆå¯æƒ³è€ŒçŸ¥ï¼Œåœ¨æ‰§è¡Œé˜¶æ®µçš„æ—¶å€™ï¼Œä¸¤ä¸ªgetNameå‡½æ•°çš„æ‰§è¡Œéƒ½è°ƒç”¨çš„æ˜¯ç¬¬äºŒä¸ªå‡½æ•°ã€‚<br>æ€»ç»“<br>JavaScriptçš„æ‰§è¡Œæœºåˆ¶ï¼Œå…ˆç¼–è¯‘ï¼Œå†æ‰§è¡Œã€‚åœ¨ç¼–è¯‘é˜¶æ®µï¼Œå˜é‡å’Œå‡½æ•°ä¼šè¢«å­˜æ”¾åˆ°å˜é‡ç¯å¢ƒä¸­ï¼Œå˜é‡çš„é»˜è®¤å€¼ä¼šè¢«è®¾ç½®ä¸ºundefinedï¼›åœ¨ä»£ç æ‰§è¡Œé˜¶æ®µï¼ŒJavaScriptå¼•æ“ä¼šä»å˜é‡ç¯å¢ƒä¸­å»æŸ¥æ‰¾è‡ªå®šä¹‰çš„å˜é‡å’Œå‡½æ•°ã€‚å¹¶ä¸”å¦‚æœåœ¨ç¼–è¯‘é˜¶æ®µå¦‚æœå­˜åœ¨ä¸¤ä¸ªç›¸åŒçš„å‡½æ•°ï¼Œé‚£ä¹ˆæœ€ç»ˆå­˜æ”¾åœ¨å˜é‡ç¯å¢ƒä¸­çš„æ˜¯æœ€åå®šä¹‰çš„é‚£ä¸ªï¼Œå› ä¸ºå®ƒçš„é€»è¾‘æ˜¯åå®šä¹‰çš„ä¼šè¦†ç›–å…ˆå®šä¹‰çš„ã€‚</p>
</div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/2020/08/22/%E6%89%8B%E5%86%99Promise/">æ‰‹å†™Promise</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-08-22</span></span></div></header><div class="post-body"><div class="post-excerpt"><p>è¯´åˆ°å¼‚æ­¥ç¼–ç¨‹ï¼Œå¤§å®¶åº”è¯¥ä¼šæƒ³åˆ°Promiseã€‚æƒ³å¿…å¯¹å®ƒå¯¹å…¸å‹çš„è®¤çŸ¥åº”è¯¥å°±æ˜¯â€”â€”è§£å†³äº†å›è°ƒåœ°ç‹±çš„é—®é¢˜ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨ï¼ˆä¸åœçš„.then .thenï¼‰çš„æ–¹å¼æ¥é¿å…å¤§é‡åµŒå¥—ã€‚å¯¹äºæˆ‘ä¸ªäººè€Œè¨€ï¼Œåœ¨ä½¿ç”¨Promiseçš„è¿‡ç¨‹ä¸­è¿˜æ˜¯éš¾å…å‡ºç°ä¸€äº›é—®é¢˜ï¼Œæ„Ÿè§‰ä»åœç•™åœ¨ç¨€é‡Œç³Šæ¶‚ç”¨çš„è¿™ä¹ˆä¸€ä¸ªé˜¶æ®µã€‚ä»Šå¤©æˆ‘æƒ³é€šè¿‡å®ç°ä¸€ä¸ªPromiseæ¥å½»åº•ææ‡‚å…¶åŸç†ã€‚<br>Promiseæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºä¸€ä¸ªå®¹å™¨ï¼Œå®ƒé‡Œè¾¹ä¿å­˜äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœã€‚è¿™é‡Œæœ‰ä¸€ä¸ª<span class="exturl"><a class="exturl__link"   href="https://promisesaplus.com/"  target="_blank" rel="noopener">Promises/A+è§„èŒƒ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>,æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å…¶ä¸­çš„æè¿°æ¥ä¸€æ­¥ä¸€æ­¥çš„å®ç°ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„Promiseã€‚<br>Promiseæœ‰ä¸‰ä¸ªçŠ¶æ€ï¼Œç­‰å¾…ã€æˆåŠŸå’Œå¤±è´¥ï¼Œé»˜è®¤æ˜¯ç­‰å¾…çŠ¶æ€ã€‚å¹¶ä¸”ä¸€æ—¦æˆåŠŸæˆ–è€…å¤±è´¥äº†çŠ¶æ€å°±ä¸èƒ½æ”¹å˜äº†ã€‚<br>resolveæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºexcutorï¼Œå®ƒæ˜¯ä¸€ä¸ªæ‰§è¡Œå™¨ï¼Œä¼šç«‹å³æ‰§è¡Œã€‚å®ƒæœ‰ä¸¤ä¸ªå‚æ•°resolveå’Œrejectï¼Œåˆ†åˆ«ä»£è¡¨æˆåŠŸå’Œå¤±è´¥ã€‚resolveä»£è¡¨çš„æ˜¯æˆåŠŸï¼Œå®ƒä¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°valueï¼ŒçŠ¶æ€æ”¹å˜ä¸ºfulfilledã€‚rejectä»£è¡¨çš„æ˜¯å¤±è´¥ï¼Œæ¥æ”¶å‚æ•°reasonï¼ŒçŠ¶æ€æ”¹å˜ä¸ºrejectedã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒçŠ¶æ€å˜ä¸ºæˆåŠŸæˆ–è€…å¤±è´¥åä¸èƒ½å†æ¬¡è¢«æ›´æ”¹ï¼Œå¦‚æœnew Promiseçš„æ—¶å€™throw new ErroræŠ¥é”™ä¹Ÿä¼šå˜æˆå¤±è´¥æ€ã€‚<br>æ¯ä¸ªPromiseåº”è¯¥æœ‰è‡ªå·±çš„ä¸‰ä¸ªçŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒæ”¾åœ¨æ„é€ å‡½æ•°é‡Œã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PENDING = <span class="string">'PENDING'</span>;</span><br><span class="line"><span class="keyword">const</span> RESOLVED = <span class="string">'RESOLVED'</span>;</span><br><span class="line"><span class="keyword">const</span> REJECTED = <span class="string">'REJECTED'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Promise</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(executor)&#123;</span><br><span class="line">    <span class="keyword">this</span>.status = PENDING;<span class="comment">//é»˜è®¤æ˜¯PENDINGçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">this</span>.value = <span class="literal">undefined</span>;<span class="comment">//æˆåŠŸ</span></span><br><span class="line">    <span class="keyword">this</span>.error = <span class="literal">undefined</span>;<span class="comment">//å¤±è´¥</span></span><br><span class="line">    <span class="keyword">let</span> resolve = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.status === PENDING)<span class="comment">//çŠ¶æ€ä¸ºPENDINGæ—¶æ‰èƒ½æ”¹å˜ &#123;</span></span><br><span class="line">        <span class="keyword">this</span>.status = RESOLVED;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">let</span> reject = <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.status === PENDING) &#123;</span><br><span class="line">        <span class="keyword">this</span>.status = REJECTED;</span><br><span class="line">        <span class="comment">// å‚¨å­˜å¤±è´¥ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">this</span>.error = error;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      executor(resolve, reject);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      reject(e);<span class="comment">//æ‰§è¡Œå™¨æ‰§è¡Œæ—¶å†…éƒ¨å¯èƒ½æŠ¥é”™</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>æ¯ä¸ªpromiseå®ä¾‹éƒ½æœ‰ä¸€ä¸ªthenæ–¹æ³•ï¼Œå¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼ŒonFulfilledå’ŒonRejectedã€‚å¦‚æœå½“å‰çŠ¶æ€æˆåŠŸæˆ‘ä»¬è°ƒç”¨onfFlfilledï¼Œå¤±è´¥è°ƒç”¨onRejected.</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">then(onFulfilled,onRejected) &#123;</span><br><span class="line">   <span class="comment">// çŠ¶æ€ä¸ºfulfilledï¼Œæ‰§è¡ŒonFulfilledï¼Œä¼ å…¥æˆåŠŸçš„å€¼</span></span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.status === RESOLVED) &#123;</span><br><span class="line">     onFulfilled(<span class="keyword">this</span>.value);</span><br><span class="line">   &#125;;</span><br><span class="line">   <span class="comment">// çŠ¶æ€ä¸ºrejectedï¼Œæ‰§è¡ŒonRejectedï¼Œä¼ å…¥å¤±è´¥çš„åŸå› </span></span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.state === REJECTED) &#123;</span><br><span class="line">     onRejected(<span class="keyword">this</span>.error);</span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></div></figure>

<p>å½“resolveåœ¨setTomeouté‡Œè¿è¡Œçš„æ—¶å€™ï¼Œä¸Šè¾¹çš„å†™æ³•å°±ä¸èƒ½æ»¡è¶³è¦æ±‚å•¦ã€‚æˆ‘ä»¬å¯ä»¥é‡‡å–å‘å¸ƒè®¢é˜…çš„æ€æƒ³ï¼Œç°å°†è¦æ‰§è¡Œçš„æ–¹æ³•å­˜åˆ°æ•°ç»„é‡Œï¼Œå½“çŠ¶æ€æ”¹å˜åå†æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> resolve = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.state === PENDING) &#123;</span><br><span class="line">    <span class="keyword">this</span>.state = RESOLVED;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">    <span class="keyword">this</span>.onResolvedCallbacks.forEach(<span class="function"><span class="params">fn</span>=&gt;</span>fn());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> reject = <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.status === PENDING) &#123;</span><br><span class="line">    <span class="keyword">this</span>.status = REJECTED;</span><br><span class="line">    <span class="keyword">this</span>.error = reason;</span><br><span class="line">    <span class="keyword">this</span>.onRejectedCallbacks.forEach(<span class="function"><span class="params">fn</span>=&gt;</span>fn());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">then(onFulfilled, onRejected) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.status === PENDING) &#123;</span><br><span class="line">  <span class="keyword">this</span>.onResolvedCallbacks.push(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    onFulfilled(<span class="keyword">this</span>.value);</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">this</span>.onRejectedCallbacks.push(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    onRejected(<span class="keyword">this</span>.error);</span><br><span class="line">  &#125;)</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>æˆ‘ä»¬éœ€è¦åˆ¤æ–­thenä¸­ä¼ é€’å‡½æ•°çš„è¿”å›ç»“æœã€‚å½“è¿”å›ç»“æœæ˜¯promiseæ—¶ï¼Œåˆ™é‡‡ç”¨å…¶çŠ¶æ€ã€‚å¦‚æœä¸æ˜¯promiseã€‚å°†ç»“æœä¼ é€’ä¸‹å»å³å¯ã€‚Promiseé€šè¿‡é“¾å¼è°ƒç”¨æ¥è§£å†³å›è°ƒåœ°ç‹±ï¼Œä¹Ÿå°±æ˜¯åœ¨ç¬¬ä¸€ä¸ªthené‡Œè¿”å›é‡Œä¸€ä¸ªPromiseã€‚æˆ‘ä»¬å¯ä»¥åœ¨thené‡Œé¢è¿”å›ä¸€ä¸ªæ–°çš„promise,ç§°ä¸ºpromise2ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.status === RESOLVED) &#123;</span><br><span class="line">    <span class="keyword">let</span> x = onFulfilled(<span class="keyword">this</span>.value);</span><br><span class="line">    <span class="comment">// å½“xä¸ºæ™®é€šå€¼æ—¶ï¼Œé€šè¿‡resolveä¿å­˜å€¼ã€‚å¦‚æœæ˜¯promiseåˆ™è¦è°ƒç”¨thenã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªå…¬å…±æ–¹æ³•æ¥è§£æxçš„å€¼å’Œpromise2çš„å…³ç³»ã€‚è¿™é‡Œè¦æ³¨æ„promiseå¿…é¡»å£°æ˜å®Œåæ‰èƒ½ä¼ å…¥resolvePromiseæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨setTimeoutå®ä»»åŠ¡åšå»¶è¿Ÿï¼Œå¯ä»¥ä¿è¯å¾—åˆ°çš„æ˜¯å£°æ˜åçš„promise2</span></span><br><span class="line">    resolvePromise(promise2, x, resolve, reject);</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></div></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°resolvePromiseè¿™ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolvePromise</span>(<span class="params">promise2, x, resolve, reject</span>)</span>&#123;</span><br><span class="line">  <span class="comment">//é¦–å…ˆå®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ¤æ–­xçš„å€¼æ˜¯ä¸æ˜¯resolveã€‚è€Œä¸”å®ƒçš„å†™æ³•è¦å…¼å®¹æ‰€æœ‰çš„promiseæƒ…å†µ</span></span><br><span class="line">   <span class="comment">// å¦‚æœpromise2å’Œxé“¾æ¥çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™æŠ¥é”™ã€‚æ¯”å¦‚let promise2 = p.then(() =&gt; &#123; return promise2 &#125;)</span></span><br><span class="line">   <span class="keyword">if</span>(x === promise2)&#123;</span><br><span class="line">     <span class="comment">// rejectæŠ¥é”™</span></span><br><span class="line">     <span class="keyword">return</span> reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'å¾ªç¯å¼•ç”¨å•¦'</span>));</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// é˜²æ­¢å¤šæ¬¡è°ƒç”¨</span></span><br><span class="line">   <span class="keyword">let</span> called;</span><br><span class="line">   <span class="keyword">if</span> (x != <span class="literal">null</span> &amp;&amp; (<span class="keyword">typeof</span> x === <span class="string">'object'</span> || <span class="keyword">typeof</span> x === <span class="string">'function'</span>)) &#123;</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="comment">// A+è§„å®šï¼Œå£°æ˜then = xçš„thenæ–¹æ³•</span></span><br><span class="line">       <span class="keyword">let</span> then = x.then;</span><br><span class="line">       <span class="comment">// å¦‚æœthenæ˜¯å‡½æ•°, å¯ä»¥é»˜è®¤è®¤ä¸ºæ˜¯promiseäº†</span></span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">typeof</span> then === <span class="string">'function'</span>) &#123; </span><br><span class="line">         <span class="comment">//yå¯èƒ½è¿˜æ˜¯ä¸€ä¸ªpromiseï¼Œç›´åˆ°è§£æå‡ºçš„ç»“æœæ˜¯ä¸€ä¸ªæ™®é€šå€¼</span></span><br><span class="line">         then.call(x, y =&gt; &#123;</span><br><span class="line">           <span class="keyword">if</span> (called) <span class="keyword">return</span>;</span><br><span class="line">           called = <span class="literal">true</span>;</span><br><span class="line">           resolvePromise(promise2, y, resolve, reject);</span><br><span class="line">         &#125;, err =&gt; &#123;</span><br><span class="line">           <span class="keyword">if</span> (called) <span class="keyword">return</span>;</span><br><span class="line">           called = <span class="literal">true</span>;</span><br><span class="line">           reject(err);<span class="comment">// é‡‡ç”¨å¤±è´¥ç»“æœå‘ä¸‹ä¼ é€’</span></span><br><span class="line">         &#125;)</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         resolve(x); <span class="comment">// è¯´æ˜xæ˜¯æ™®é€šå¯¹è±¡ï¼Œç›´æ¥æˆåŠŸå³å¯</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">       <span class="comment">//é˜²æ­¢å¤šæ¬¡è°ƒç”¨æˆåŠŸå’Œå¤±è´¥</span></span><br><span class="line">       <span class="keyword">if</span> (called) <span class="keyword">return</span>;</span><br><span class="line">       called = <span class="literal">true</span>;</span><br><span class="line">       reject(e); </span><br><span class="line">     &#125;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     resolve(x);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></div></figure>

<p>onFulfilledå’ŒonRejectedå‡ä¸ºå¯é€‰å‚æ•°ã€‚<br>onFulfilledè¿”å›ä¸€ä¸ªæ™®é€šçš„å€¼ï¼ŒæˆåŠŸæ—¶ç›´æ¥ç­‰äº data =&gt; data<br>onRejectedè¿”å›ä¸€ä¸ªæ™®é€šçš„å€¼ï¼Œå¤±è´¥æ—¶å¦‚æœç›´æ¥ç­‰äº data =&gt; dataï¼Œåˆ™ä¼šè·‘åˆ°ä¸‹ä¸€ä¸ªthenä¸­çš„onFulfilledä¸­ï¼Œæ‰€ä»¥ç›´æ¥æ‰”å‡ºä¸€ä¸ªé”™è¯¯</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onFulfilled = <span class="keyword">typeof</span> onFulfilled === <span class="string">'function'</span> ? onFulfilled : <span class="function"><span class="params">data</span> =&gt;</span> data;</span><br><span class="line"><span class="comment">// onRejectedå¦‚æœä¸æ˜¯å‡½æ•°ï¼Œå°±å¿½ç•¥onRejectedï¼Œç›´æ¥æ‰”å‡ºé”™è¯¯</span></span><br><span class="line">onRejected = <span class="keyword">typeof</span> onRejected === <span class="string">'function'</span> ? onRejected : <span class="function"><span class="params">err</span> =&gt;</span> &#123; <span class="keyword">throw</span> err &#125;;</span><br></pre></td></tr></table></div></figure>

<p>å®ç°äº†Promiseï¼Œé‚£ä¹ˆå®ƒçš„allæ–¹æ³•å’Œraceæ–¹æ³•ç›¸å¯¹æ¥è¯´å°±æ¯”è¾ƒå¥½å®ç°äº†ã€‚<br>Promise.all()æ–¹æ³•ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚<br>åªæœ‰ä¼ å…¥æ‰€æœ‰å®ä¾‹çš„çŠ¶æ€éƒ½å˜æˆfulfilledï¼Œæ–°çš„promisesçš„çŠ¶æ€æ‰ä¼šå˜æˆfulfilledï¼Œæ­¤æ—¶æ¯ä¸ªå®ä¾‹çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ é€’ç»™promisesçš„å›è°ƒå‡½æ•°ã€‚<br>åªè¦ä¹‹ä¸­æœ‰ä¸€ä¸ªè¢«rejectedï¼Œpçš„çŠ¶æ€å°±å˜æˆrejectedï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢«rejectçš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™æ•´ä¸ªpromisesçš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all = <span class="function"><span class="keyword">function</span> (<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//promisesæ˜¯ä¸€ä¸ªpromiseçš„æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">let</span> arr = []; <span class="comment">//arræ˜¯æœ€ç»ˆè¿”å›å€¼çš„ç»“æœ</span></span><br><span class="line">      <span class="keyword">let</span> successCount = <span class="number">0</span>; <span class="comment">// è¡¨ç¤ºæˆåŠŸäº†å¤šå°‘æ¬¡</span></span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">processData</span>(<span class="params">index, data</span>) </span>&#123;</span><br><span class="line">          arr[index] = data;</span><br><span class="line">          successCount++;</span><br><span class="line">          <span class="keyword">if</span> (successCount === promises.length) &#123;</span><br><span class="line">              resolve(arr);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; promises.length; i++) &#123;</span><br><span class="line">          promises[i].then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">              processData(i, data)</span><br><span class="line">          &#125;, reject)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>Promise.raceä¹Ÿæ˜¯å°†å¤šä¸ªPromiseå®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œåªè¦æœ‰å…¶ä¸­ä¸€ä¸ªå®ä¾‹æ”¹å˜çŠ¶æ€é‚£ä¹ˆæ•´ä¸ªå®ä¾‹çŠ¶æ€æ”¹å˜å¹¶åœæ­¢æ‰§è¡Œã€‚</p>
<figure class="highlight js"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.race = <span class="function"><span class="keyword">function</span>(<span class="params">promises</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> len = promises.length;</span><br><span class="line">    <span class="keyword">if</span>(len === <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="built_in">Promise</span>.resolve(promise[i]).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        resolve(data);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        reject(err);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/avatar.jpeg" alt="avatar"></div><p class="sidebar-ov-author__text">è°ä¸æ˜¯ï¼Œæ‹¼äº†å‘½èµ°åˆ°ç»“å°¾ï¼Œä¹Ÿè®¸å‘å¾®ï¼Œä¸€ç”Ÿç‹¼ç‹ˆ</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">16</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright Â© 2021</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>å‰ç«¯ä¸€å²å°ç™½-able.Feng</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v4.2.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.0.0-rc.0</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.0.0-rc.0"></script><script src="/js/stun-boot.js?v=2.0.0-rc.0"></script><script src="/js/scroll.js?v=2.0.0-rc.0"></script><script src="/js/header.js?v=2.0.0-rc.0"></script><script src="/js/sidebar.js?v=2.0.0-rc.0"></script></body></html>